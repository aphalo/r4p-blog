<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.544">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Pedro J. Aphalo">
<meta name="dcterms.date" content="2023-08-14">
<meta name="keywords" content="ggplot2 pkg, ggpp pkg, ggpmisc pkg, data labels, plot annotations, pairwise">
<title>Using R for Photobiology - Multiple comparisons with ‘ggpmisc’</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../r4p-favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../r4p-logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Using R for Photobiology</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../posts.html"> <i class="bi bi-newspaper" role="img">
</i> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../pages.html"> <i class="bi bi-file-richtext" role="img">
</i> 
<span class="menu-text">Pages</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../galleries.html"> <i class="bi bi-images" role="img">
</i> 
<span class="menu-text">R gallery</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-packages" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-box-seam" role="img">
</i> 
 <span class="menu-text">R packages</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-r-packages">
<li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/"><i class="bi bi-list" role="img">
</i> 
 <span class="dropdown-text">Documentation Index</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://r.r4photobiology.info/"><i class="bi bi-cloud-download" role="img">
</i> 
 <span class="dropdown-text">CRAN-like repository</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/learnrbook/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">learnrbook</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../pages/ggpmisc-intro.html"><i class="bi bi-stack" role="img">
</i> 
 <span class="dropdown-text">Intro <em>‘ggpmisc’, ‘ggpp’ and ‘gginnards’</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ggpmisc/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">ggpmisc</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ggpp/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">ggpp</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/gginnards/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">gginnards</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../pages/r4p-introduction.html"><i class="bi bi-sun" role="img">
</i> 
 <span class="dropdown-text">Intro <em>R for Photobiology Suite</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiology/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ggspectra/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">ggspectra</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyWavebands/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiologyWavebands</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyInOut/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiologyInOut</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ooacquire/"><i class="bi bi-rulers" role="img">
</i> 
 <span class="dropdown-text">ooacquire</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/rOmniDriver/"><i class="bi bi-rulers" role="img">
</i> 
 <span class="dropdown-text">rOmniDriver</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyPlants/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiologyPlants</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyLamps/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologyLamps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyLEDs/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologyLEDs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologySun/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologySun</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyFilters/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologyFilters</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologySensors/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologySensors</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../pages/packages-status.html"><i class="bi bi-check-all" role="img">
</i> 
 <span class="dropdown-text">Checks and issues</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-books" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Books</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-books">
<li>
    <a class="dropdown-item" href="https://www.learnr-book.info/"><i class="bi bi-book" role="img">
</i> 
 <span class="dropdown-text">Book <em>Learn R - As a Language</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pages/beyond-the-visible.html"><i class="bi bi-book" role="img">
</i> 
 <span class="dropdown-text">Handbook <em>Beyond the Visible</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pages/r4p-book.html"><i class="bi bi-book-half" role="img">
</i> 
 <span class="dropdown-text">Book <em>R for Photobiology</em></span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-person" role="img">
</i> 
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-about">
<li>
    <a class="dropdown-item" href="../about/help.html"><i class="bi bi-question-square" role="img">
</i> 
 <span class="dropdown-text">Site Help</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../about/about.html"><i class="bi bi-pc-display" role="img">
</i> 
 <span class="dropdown-text">About <em>this site</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../about/pedro.html"><i class="bi bi-person" role="img">
</i> 
 <span class="dropdown-text">About <em>Pedro J. Aphalo</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/aphalo/r4p-blog/"><i class="bi bi-github" role="img">
</i> 
 <span class="dropdown-text">Source of <em>this site</em> at GitHub</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-rss-feeds" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text">RSS feeds</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-rss-feeds">
<li>
    <a class="dropdown-item" href="../posts.xml"><i class="bi bi-newspaper" role="img">
</i> 
 <span class="dropdown-text">Blog RSS feed</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pages.xml"><i class="bi bi-file-richtext" role="img">
</i> 
 <span class="dropdown-text">Pages RSS feed</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../galleries.xml"><i class="bi bi-images" role="img">
</i> 
 <span class="dropdown-text">Gallery RSS feed</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Multiple comparisons with ‘ggpmisc’</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Letter labels and labelled bars</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Plotting examples</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Pedro J. Aphalo </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2023-08-14</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">2023-11-24</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">Abstract</div>
      <p>Examples of plots with pairwise labels and letter labels created with <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> from R package ‘ggpmisc’. Function <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> computes and adds to ggplots the results from multiple comparison tests as labels. Multiple comparisons based on Tukey and Dunnet contrasts are demonstrated.</p>
    </div>
  </div>

  <div>
    <div class="keywords">
      <div class="block-title">Keywords</div>
      <p>ggplot2 pkg, ggpp pkg, ggpmisc pkg, data labels, plot annotations, pairwise</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#plot-annotations-for-multiple-comparison-tests" id="toc-plot-annotations-for-multiple-comparison-tests" class="nav-link active" data-scroll-target="#plot-annotations-for-multiple-comparison-tests">Plot annotations for multiple comparison tests</a></li>
  <li>
<a href="#multiple-comparisons-in-ggplots" id="toc-multiple-comparisons-in-ggplots" class="nav-link" data-scroll-target="#multiple-comparisons-in-ggplots">Multiple comparisons in ggplots</a>
  <ul class="collapse">
<li><a href="#package-ggpp-0.5.4" id="toc-package-ggpp-0.5.4" class="nav-link" data-scroll-target="#package-ggpp-0.5.4">Package ‘ggpp’ (&gt;= 0.5.4)</a></li>
  </ul>
</li>
  <li><a href="#package-ggpmisc-0.5.4" id="toc-package-ggpmisc-0.5.4" class="nav-link" data-scroll-target="#package-ggpmisc-0.5.4">Package ‘ggpmisc’ (&gt;= 0.5.4)</a></li>
  <li>
<a href="#plot-examples-with-code" id="toc-plot-examples-with-code" class="nav-link" data-scroll-target="#plot-examples-with-code">Plot examples with code</a>
  <ul class="collapse">
<li><a href="#using-default-labels" id="toc-using-default-labels" class="nav-link" data-scroll-target="#using-default-labels">Using default labels</a></li>
  <li><a href="#using-pre-built-labels-other-than-default" id="toc-using-pre-built-labels-other-than-default" class="nav-link" data-scroll-target="#using-pre-built-labels-other-than-default">Using pre-built labels other than default</a></li>
  <li><a href="#using-other-aesthetics-than-the-default" id="toc-using-other-aesthetics-than-the-default" class="nav-link" data-scroll-target="#using-other-aesthetics-than-the-default">Using other aesthetics than the default</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The examples in this page make use of packages ‘ggpmisc’ (&gt;= 0.5.5.9000) and ‘ggpp’ (&gt;= 0.5.5) not yet available through CRAN. In ‘ggpmisc’ 0.5.4 and 0.5.5 <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> was a preliminary implementation that will change in future version 0.5.6. Versions before 0.5.4 lack the layer functions described in this page.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this page most code chunks are “folded” so as to decrease the clutter when searching for examples. A few code chunks that are reused across several plots are by default unfolded to make them more visible. Above each plot you will find one or more “folded” code chunks signalled by a small triangle followed by “Code”. Clicking on the triangle “unfolds” the code chunk making visible the R code used to produce the plot.</p>
<p>The code in the chunks can be copied by clicking on the top right corner, where an icon appears when the mouse cursor hovers over the code listing.</p>
<p>The <code>&lt;/&gt; Code</code> drop down menu to the right of the page title makes it possible to unfold all code chunks and to view the Quarto source of the whole web page.</p>
<p>Names of functions and other R objects are linked to the corresponding on-line help pages. The names of R extension packages are linked to their documentation web sites when available.</p>
</div>
</div>
<section id="plot-annotations-for-multiple-comparison-tests" class="level2"><h2 class="anchored" data-anchor-id="plot-annotations-for-multiple-comparison-tests">Plot annotations for multiple comparison tests</h2>
<p>Data labels add textual information directly related to individual data points (shown as glyphs), such as original observations or summaries such as means. The position of labels in this case is dependent on the scales used to represent data points. Text is usually displaced so that it does not occlude the glyph representing the data point and when the link to the data point is unclear, this link is signalled with a line segment or arrow. Data labels are distinct from annotations in that they contribute directly to the representation of data on a plot or map.</p>
<p>Annotations differ from data labels, in that their position is decoupled from their meaning. Insets can be thought as larger, but still self-contained annotations. In most cases the reading of inset tables and plots depends only weakly on the plot or map in which they are included.</p>
<p>In the case of annotations and insets the designer of a data visualization has the freedom to locate them anywhere, as long as they do not occlude features used to describe data.</p>
<p>The letter labels and labelled segments used to highlight pairwise comparisons are a special case as they behave as data labels along the axis onto which an explanatory factor has been mapped, usually <em>x</em>, but frequently as annotations along the axis onto which a continuous numeric variable has been mapped, usually <em>y</em>.</p>
</section><section id="multiple-comparisons-in-ggplots" class="level2"><h2 class="anchored" data-anchor-id="multiple-comparisons-in-ggplots">Multiple comparisons in ggplots</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Multiple comparisons are frequently applied as post-hoc tests, in many cases including all possible pairwise contrasts (Tukey contrasts) or every treatment individually against a control condition (Dunnet contrasts). As post-hoc tests, they are seen as a way of investigating the source of an overall significant difference, and multiple comparisons are applied only if the main effect of the factor is in itself significant and skipped otherwise. In other cases multiple comparisons can be the primary statistical test addressing the research hypotheses. Both approaches are valid as long as the hypotheses have been set independently of the data being used in the test. <strong>What should be avoided is to cherry pick promising pairwise tests based on the data, and then correct the <em>P</em>-values taking into account only the cherry-picked pairs.</strong></p>
<p>When applying multiple comparisons, it is necessary to adjust the <em>P</em>-values taking into account the fact the the more numerous the tests, the more likely is that at least one or a few of them will yield false positive outcomes. There are different approaches, that can be grouped into methods that attempt control the experiment-wise probability of false positive outcomes to a given <em>P</em>-level, such as 0.05, and those that attempt to control the false discovery rate, that can be thought of as the proportion of the tests that yield false positive outcomes. There are variations in both approaches, varying in power and conservativeness.</p>
</div>
</div>
<p>Package <a href="https://const-ae.github.io/ggsignif/">ggsignif</a> seems to be the most popular (only?) implementation of pairwise comparisons for ggplots. I have used this package and it does a a good job for automating some simple tests, but it has limitations. Recently I wished to have more flexible formatting of labels using <em>plotmath expressions</em> as well as the ability to adjust <em>P</em>-values using multiple comparison statistical procedures. Presenting adjusted <em>P</em>-values is of crucial importance and in my view should be the default behaviour. There is an issue at GitHub and questions in StackOverflow wishing this to be supported.</p>
<p>Package <a href="https://const-ae.github.io/ggsignif/">ggsignif</a>, although maintained, is no longer under active development. The authors suggest creating pull requests for new features. I studied the code and it seems to me that the coupling between the statistic and geometry is unnecessarily tight and would make it difficult to create a pull request that fulfils the needs stated above.</p>
<p>In particular, the <em>manual</em> mode of <code>stat_signif()</code> seems like an afterthought modification to the statistic, and does not follow the expectations of the grammar of graphics that statistics do computations and geometries create a graphical representation. So, I decided to implement from scratch enhanced functionality in packages <a href="https://docs.r4photobiology.info/ggpp/">ggpp</a> and <a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a> to complement that in package <a href="https://const-ae.github.io/ggsignif/">ggsignif</a>.</p>
<p>Package <a href="https://docs.r4photobiology.info/ggpp/">ggpp</a> mainly defines geometries and scales that can be useful for the development of other packages. Package <a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a> implements mostly statistics and also imports and re-exports package <a href="https://docs.r4photobiology.info/ggpp/">ggpp</a>.</p>
<p>Package <a href="https://const-ae.github.io/ggsignif/">ggsignif</a>, defines <code>geom_signif()</code> and <code>stat_signif()</code>, implementing pairwise <em>t</em>-tests and other pairwise tests. In this statistic, tests are done individually, not as multiple comparisons. In some cases this is o.k., but in most cases it is the wrong approach to testing contrasts that are not orthogonal. R package ‘multcomp’ is well established and implements flexibly several different methods, including modern ones, to adjust <em>P</em>-values from multiple comparisons.</p>
<section id="package-ggpp-0.5.4" class="level3"><h3 class="anchored" data-anchor-id="package-ggpp-0.5.4">Package ‘ggpp’ (&gt;= 0.5.4)</h3>
<p>I added two new geometries,<code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_text_pairwise()</a></code> and <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_label_pairwise()</a></code> to package <a href="https://docs.r4photobiology.info/ggpp/">ggpp</a>. Writing the code of <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_text_pairwise()</a></code> and <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_label_pairwise()</a></code> was easy, using the existing code of <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_s.html">geom_text_s()</a></code> and <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_s.html">geom_label_s()</a></code> as a base. The user interface is, thus, consistent with that of other related layer functions in package <a href="https://docs.r4photobiology.info/ggpp/">ggpp</a>. These geometries are fully functional on their own and by default make use of <code><a href="https://ggplot2.tidyverse.org/reference/stat_identity.html">ggplot2::stat_identity()</a></code>. Examples of plots with R code making use of them are available in page <a href="https://www.r4photobiology.info/galleries/pairwise-labels.html">Pairwise labels with ‘ggpp’</a>.</p>
<p>These geometries are convenience layer functions when used on their own as the same plots can be created by adding separately the segment and text or label layers to a plot. However, they become a necessity, when designing a statistic.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Functions <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_text_pairwise()</a></code> and <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_label_pairwise()</a></code> are still under development and have some limitations. An important one is that the segment of bar labels created with <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_label_pairwise()</a></code> extends under the label box, thus making the use of <code>alpha</code> transparency impossible. In addition, the behaviour of the <code>linewidth</code> aesthetic with <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_label_pairwise()</a></code> can be surprising.</p>
<p><em>Some features of the user interface of <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_text_pairwise()</a></code> and <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_label_pairwise()</a></code> may change in future versions of the package.</em></p>
</div>
</div>
</section></section><section id="package-ggpmisc-0.5.4" class="level2"><h2 class="anchored" data-anchor-id="package-ggpmisc-0.5.4">Package ‘ggpmisc’ (&gt;= 0.5.4)</h2>
<p>I have added to package <a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a> (&gt;= 0.5.4) a new statistic, <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code>, that makes some of the features from function <code>glht()</code> from package <a href="http://multcomp.r-forge.r-project.org/">multcomp</a> easy to use to add a plot layer highlighting the outcome of these tests. In ‘ggpmisc’ (&gt;= 0.5.6) additional features are supported.</p>
<p>Layer function <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> first fits a model (a linear model by default) followed by a multiple comparisons test with a user-controlled adjustment to the <em>P</em>-values. By default <code>"Tukey"</code> contrasts are computed but <code>"Dunnet"</code> contrasts are also supported. The implementation makes use of function <code>glht()</code> from package <a href="http://multcomp.r-forge.r-project.org/">multcomp</a> making available all the methods it supports for the adjustment of <em>P</em>-values for multiple comparisons. Currently, <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> only implements pairwise contrasts, as in this case there are well established approaches to plot annotations. By passing a numeric matrix as argument arbitrary sets of <em>pairwise</em> contrasts can be specified. Contrasts that involve more than two levels of a factor are not yet supported.</p>
<p>The returned data contains both numeric and ready formatted character strings. The returned value and default geometry depend on the type of label, that can be either bars (connecting segments) labelled with <em>P</em>-values or other parameters, or letters. With bars, plots get crowded easily, and are supported for factors with two to five levels if using “Tukey” contrasts. In contrast, encoding pairwise difference from “Tukey” contrasts as letters is possible with factors with two or more levels. <em>Letter encoding is not implemented for “Dunnet” contrasts as such encoding is unsuitable in this case.</em></p>
<p>As other layer functions in R package <a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a> , <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> attempts to be flexible, both in the statistical methods used to test multiple comparisons and in the way the outcomes can be shown in plots. As this is a safe (= conservative) approach, the adjustment of <em>P</em>-values is enabled by default.</p>
<p>Even if flexible, <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> does not cater for all uses of multiple comparisons, and it is to be expected that in some cases multiple comparison tests will be applied before plotting, and the outcomes shown in plots using geometries rather than statistics. Examples of such use of geometries <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_text_pairwise()</a></code> and <code><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_pairwise.html">geom_label_pairwise()</a></code> are available in the page <a href="../galleries/pairwise-labels.html">Pairwise labels with ‘ggpp’</a>.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Function <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> is still under development and has some limitations. Currently, only “Tukey” and “Dunnet” contrasts are supported and the order of letters in letter labels is fixed. This statistic has been tested only with <code>method = "lm"</code>, <code>method = "aov"</code> and <code>method = "rlm"</code>although several other model fit functions can be expected also to work.</p>
<p><em>Some features of the user interface of <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> may change in future versions of the package.</em></p>
</div>
</div>
</section><section id="plot-examples-with-code" class="level2"><h2 class="anchored" data-anchor-id="plot-examples-with-code">Plot examples with code</h2>
<p>Package <a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a> imports and re-exports all definitions from <a href="https://docs.r4photobiology.info/ggpp/">ggpp</a> as well as from <a href="https://ggplot2.tidyverse.org/">ggplot2</a>, so it is enough to attach explicitly package <a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a> . All three packages are available through CRAN.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a></span><span class="op">)</span></span>
<span><span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="using-default-labels" class="level3"><h3 class="anchored" data-anchor-id="using-default-labels">Using default labels</h3>
<p>Tukey’s method for all pairwise contrasts using <em>honestly significant differences</em>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>label.y <span class="op">=</span> <span class="fl">12</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span>, </span>
<span>                vstep <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Using Holm’s method to adjust <em>P</em>-values.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>p.adjust.method <span class="op">=</span> <span class="st">"holm"</span>,</span>
<span>                label.y <span class="op">=</span> <span class="fl">12</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span>, </span>
<span>                vstep <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Dunnet’s method for comparison of each treatment against a control, assumed to be the first level of the factor.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"col"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>label.y <span class="op">=</span> <span class="fl">25</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A staircase of pairwise contrasts with <em>P</em>-values adjusted using Holm’s method.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"col"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>label.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">23</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Tukey’s pairwise contrasts using defaults except for the position of the lowermost bar.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"col"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span>, label.y <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Tukey’s pairwise contrasts using defaults and shown with letters.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"col"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>label.y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, </span>
<span>                label.type <span class="op">=</span> <span class="st">"letters"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"col"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>                label.type <span class="op">=</span> <span class="st">"letters"</span>,</span>
<span>                adj.method.tag <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.85</span>,</span>
<span>                label.y <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                geom <span class="op">=</span> <span class="st">"text_pairwise"</span>,</span>
<span>                vstep <span class="op">=</span> <span class="fl">0.07</span>,</span>
<span>                p.digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span>label.type <span class="op">=</span> <span class="st">"letters"</span>,</span>
<span>                geom <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Numeric <em>P</em>-values shown for Dunnet contrasts.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"col"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">stage</span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, </span>
<span>                              after_stat <span class="op">=</span> <span class="va">x.right.tip</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                label.y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, </span>
<span>                vstep <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="using-pre-built-labels-other-than-default" class="level3"><h3 class="anchored" data-anchor-id="using-pre-built-labels-other-than-default">Using pre-built labels other than default</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/use_label.html">use_label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span>,</span>
<span>                label.y <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                vstep <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>                p.digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/use_label.html">use_label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          size <span class="op">=</span> <span class="fl">2.75</span>,</span>
<span>                label.y <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                vstep <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-14-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"col"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">stage</span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, after_stat <span class="op">=</span> <span class="va">x.right.tip</span><span class="op">)</span>,</span>
<span>                    label <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">stars.label</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                label.y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, </span>
<span>                vstep <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="using-other-aesthetics-than-the-default" class="level3"><h3 class="anchored" data-anchor-id="using-other-aesthetics-than-the-default">Using other aesthetics than the default</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span>,</span>
<span>                label.y <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                vstep <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>                p.digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey50"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">2.75</span>,</span>
<span>                label.y <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                vstep <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>                p.digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                contrasts <span class="op">=</span> <span class="st">"Dunnet"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey90"</span>, <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-17-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu">after_stat</span><span class="op">(</span><span class="va">letters.label</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                label.type <span class="op">=</span> <span class="st">"letters"</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-18-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu">after_stat</span><span class="op">(</span><span class="va">letters.label</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                label.type <span class="op">=</span> <span class="st">"letters"</span>,</span>
<span>                geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                adj.method.tag <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="multcomp_files/figure-html/unnamed-chunk-19-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Additional examples are available in the documentation of function <code><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_multcomp.html">stat_multcomp()</a></code> and in the <a href="https://docs.r4photobiology.info/ggpmisc/articles/model-based-annotations.html#stat_multcomp">vignette of package ‘ggpmisc’</a>.</p>
</div>
</div>


<!-- -->

</section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb20" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Multiple comparisons with 'ggpmisc'"</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Letter labels and labelled bars"</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Pedro J. Aphalo"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-08-14"</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "2023-11-24"</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span><span class="co"> [ggplot2 pkg, ggpp pkg, ggpmisc pkg, data labels, plot annotations, pairwise]</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Plotting examples]</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> |</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">  Examples of plots with pairwise labels and letter labels created with `stat_multcomp()` from R package 'ggpmisc'. Function `stat_multcomp()` computes and adds to ggplots the results from multiple comparison tests as labels. Multiple comparisons based on Tukey and Dunnet contrasts are demonstrated.</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>The examples in this page make use of packages 'ggpmisc' (&gt;= 0.5.5.9000) and</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>'ggpp' (&gt;= 0.5.5) not yet available through CRAN. In 'ggpmisc' 0.5.4 and 0.5.5</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="in">`stat_multcomp()`</span> was a preliminary implementation that will change in future</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>version 0.5.6. Versions before 0.5.4 lack the layer functions described in this</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>page.</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>In this page most code chunks are "folded" so as to decrease the clutter when</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>searching for examples. A few code chunks that are reused across several plots</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>are by default unfolded to make them more visible. Above each plot you will find</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>one or more "folded" code chunks signalled by a small triangle followed by</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>"Code". Clicking on the triangle "unfolds" the code chunk making visible the R</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>code used to produce the plot.</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>The code in the chunks can be copied by clicking on the top right</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>corner, where an icon appears when the mouse cursor hovers over the code</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>listing.</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>The <span class="in">`&lt;/&gt; Code`</span> drop down menu to the right of the page title makes it possible</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>to unfold all code chunks and to view the Quarto source of the whole web page.</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>Names of functions and other R objects are linked to the corresponding on-line</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>help pages. The names of R extension packages are linked to their documentation</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>web sites when available.</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot annotations for multiple comparison tests</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>Data labels add textual information directly related to individual data</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>points (shown as glyphs), such as original observations or summaries such as </span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>means. The position of labels in this case is dependent on the</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>scales used to represent data points. Text is usually displaced so that</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>it does not occlude the glyph representing the data point and when the</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>link to the data point is unclear, this link is signalled with a line</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>segment or arrow. Data labels are distinct from annotations in that they</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>contribute directly to the representation of data on a plot or map.</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>Annotations differ from data labels, in that their position is decoupled</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>from their meaning. Insets can be thought as larger, but still</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>self-contained annotations. In most cases the reading of inset tables</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>and plots depends only weakly on the plot or map in which they are</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>included.</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>In the case of annotations and insets the designer of a data</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>visualization has the freedom to locate them anywhere, as long as they</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>do not occlude features used to describe data.</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>The letter labels and labelled segments used to highlight pairwise comparisons</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>are a special case as they behave as data labels along the axis onto which an</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>explanatory factor has been mapped, usually _x_, but frequently as annotations along the</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>axis onto which a continuous numeric variable has been mapped, usually _y_.</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple comparisons in ggplots</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>Multiple comparisons are frequently applied as post-hoc tests, in many cases including all possible pairwise contrasts (Tukey contrasts) or every treatment individually against a control condition (Dunnet contrasts). As post-hoc tests, they are seen as a way of investigating the source of an overall significant difference, and multiple comparisons are applied only if the main effect of the factor is in itself significant and skipped otherwise. In other cases multiple comparisons can be the primary statistical test addressing the research hypotheses. Both approaches are valid as long as the hypotheses have been set independently of the data being used in the test. **What should be avoided is to cherry pick promising pairwise tests based on the data, and then correct the _P_-values taking into account only the cherry-picked pairs.**</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>When applying multiple comparisons, it is necessary to adjust the _P_-values taking into account the fact the the more numerous the tests, the more likely is that at least one or a few of them will yield false positive outcomes. There are different approaches, that can be grouped into methods that attempt control the experiment-wise probability of false positive outcomes to a given _P_-level, such as 0.05, and those that attempt to control the false discovery rate, that can be thought of as the proportion of the tests that yield false positive outcomes. There are variations in both approaches, varying in power and conservativeness.</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>Package <span class="co">[</span><span class="ot">ggsignif</span><span class="co">](https://const-ae.github.io/ggsignif/)</span> seems to be the most</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>popular (only?) implementation of pairwise comparisons for ggplots. I have used</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>this package and it does a a good job for automating some simple tests, but it</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>has limitations. Recently I wished to have more flexible formatting of labels</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>using _plotmath expressions_ as well as the ability to adjust _P_-values using</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>multiple comparison statistical procedures. Presenting adjusted _P_-values is of</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>crucial importance and in my view should be the default behaviour. There is an</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>issue at GitHub and questions in StackOverflow wishing this to be supported.</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>Package <span class="co">[</span><span class="ot">ggsignif</span><span class="co">](https://const-ae.github.io/ggsignif/)</span>, although maintained, is no longer under active development.</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>The authors suggest creating pull requests for new features. I studied the code</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>and it seems to me that the coupling between the statistic and geometry is</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>unnecessarily tight and would make it difficult to create a pull request that</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>fulfils the needs stated above. </span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>In particular, the _manual_ mode of <span class="in">`stat_signif()`</span> seems like an</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>afterthought modification to the statistic, and does not follow the expectations</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>of the grammar of graphics that statistics do computations and geometries create</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>a graphical representation. So, I decided to implement from scratch enhanced</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>functionality in packages <span class="co">[</span><span class="ot">ggpp</span><span class="co">](https://docs.r4photobiology.info/ggpp/)</span> and <span class="co">[</span><span class="ot">ggpmisc</span><span class="co">](https://docs.r4photobiology.info/ggpmisc/)</span> to complement that in package</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">ggsignif</span><span class="co">](https://const-ae.github.io/ggsignif/)</span>.</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>Package <span class="co">[</span><span class="ot">ggpp</span><span class="co">](https://docs.r4photobiology.info/ggpp/)</span> mainly defines geometries and scales that can be useful for the</span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>development of other packages. Package <span class="co">[</span><span class="ot">ggpmisc</span><span class="co">](https://docs.r4photobiology.info/ggpmisc/)</span> implements mostly statistics</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>and also imports and re-exports package <span class="co">[</span><span class="ot">ggpp</span><span class="co">](https://docs.r4photobiology.info/ggpp/)</span>. </span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>Package <span class="co">[</span><span class="ot">ggsignif</span><span class="co">](https://const-ae.github.io/ggsignif/)</span>, defines <span class="in">`geom_signif()`</span> and <span class="in">`stat_signif()`</span>, implementing</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>pairwise _t_-tests and other pairwise tests. In this statistic, tests are done individually, not as</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>multiple comparisons. In some cases this is o.k., but in most cases it is the wrong</span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>approach to testing contrasts that are not orthogonal. R package 'multcomp' is</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>well established and implements flexibly several different methods,</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>including modern ones, to adjust _P_-values from multiple comparisons.</span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package 'ggpp' (&gt;= 0.5.4)</span></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>I added two new geometries,<span class="in">`geom_text_pairwise()`</span> and <span class="in">`geom_label_pairwise()`</span> to package <span class="co">[</span><span class="ot">ggpp</span><span class="co">](https://docs.r4photobiology.info/ggpp/)</span>. </span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>Writing the code of <span class="in">`geom_text_pairwise()`</span> and <span class="in">`geom_label_pairwise()`</span> was easy, using the existing code of <span class="in">`geom_text_s()`</span> and</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_label_s()`</span> as a base. The user interface is, thus, consistent with that of</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>other related layer functions in package <span class="co">[</span><span class="ot">ggpp</span><span class="co">](https://docs.r4photobiology.info/ggpp/)</span>. These geometries are fully</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>functional on their own and by default make use of <span class="in">`ggplot2::stat_identity()`</span>.</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>Examples of plots with R code making use of them are available in page </span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Pairwise labels with 'ggpp'</span><span class="co">](https://www.r4photobiology.info/galleries/pairwise-labels.html)</span>.</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>These geometries are convenience layer functions when used on their own as the same plots can be created by adding separately the segment and text or label layers to a plot. However, they become a necessity, when designing a</span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>statistic.</span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>Functions <span class="in">`geom_text_pairwise()`</span> and <span class="in">`geom_label_pairwise()`</span> are still under development and have some limitations. An important one is that the segment of bar labels created with <span class="in">`geom_label_pairwise()`</span> extends under the label box, thus making the use of <span class="in">`alpha`</span> transparency impossible. In addition, the behaviour of the <span class="in">`linewidth`</span> aesthetic with <span class="in">`geom_label_pairwise()`</span> can be surprising.</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>_Some features of the user interface of `geom_text_pairwise()` and `geom_label_pairwise()` may change in future versions of the package._</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Package 'ggpmisc' (&gt;= 0.5.4)</span></span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a>I have added to package <span class="co">[</span><span class="ot">ggpmisc</span><span class="co">](https://docs.r4photobiology.info/ggpmisc/)</span> (&gt;= 0.5.4) a new statistic, <span class="in">`stat_multcomp()`</span>,</span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a>that makes some of the features from function <span class="in">`glht()`</span> from package <span class="co">[</span><span class="ot">multcomp</span><span class="co">](http://multcomp.r-forge.r-project.org/)</span></span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>easy to use to add a plot layer highlighting the outcome of these tests. In 'ggpmisc' (&gt;= 0.5.6) additional features are supported.</span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>Layer function <span class="in">`stat_multcomp()`</span> first fits a model (a linear model by default) followed by a multiple comparisons test with a user-controlled adjustment to the _P_-values. By default `"Tukey"` contrasts are computed but `"Dunnet"` contrasts are also supported. The implementation makes use of function `glht()` from package [multcomp](http://multcomp.r-forge.r-project.org/) making available all the methods it supports for the adjustment of _P_-values for multiple comparisons. Currently, `stat_multcomp()` only implements pairwise contrasts, as in this case there are well established approaches to plot annotations. By passing a numeric matrix as argument arbitrary sets of _pairwise_ contrasts can be specified. Contrasts that involve more than two levels of a factor are not yet supported.</span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a>The returned data contains both numeric and ready formatted character strings. The returned value and default geometry depend on the type of label, that can be</span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a>either bars (connecting segments) labelled with _P_-values or other parameters, or letters. With bars, plots get crowded easily, and are supported for factors with two to five levels if using "Tukey" contrasts. In contrast, encoding pairwise difference from "Tukey" contrasts as letters is possible with factors with two or more levels. _Letter encoding is not implemented for "Dunnet" contrasts as such encoding is unsuitable in this case._</span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>As other layer functions in R package <span class="co">[</span><span class="ot">ggpmisc</span><span class="co">](https://docs.r4photobiology.info/ggpmisc/)</span> , <span class="in">`stat_multcomp()`</span> attempts to be flexible, both in the statistical methods used to test multiple comparisons and in the way the outcomes can be shown in plots. As this is a safe (= conservative) approach, the adjustment of _P_-values is enabled by default.</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a>Even if flexible, <span class="in">`stat_multcomp()`</span> does not cater for all uses of multiple comparisons, and it is to be expected that in some cases multiple comparison tests will be applied before plotting, and the outcomes shown in plots using geometries rather than statistics. Examples of such use of geometries <span class="in">`geom_text_pairwise()`</span> and <span class="in">`geom_label_pairwise()`</span> are available in the page <span class="co">[</span><span class="ot">Pairwise labels with 'ggpp'</span><span class="co">](pairwise-labels.qmd)</span>.</span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>Function <span class="in">`stat_multcomp()`</span> is still under development and has some limitations. Currently, only "Tukey" and "Dunnet" contrasts </span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>are supported and the order of letters in letter labels is fixed. This statistic has been tested only with <span class="in">`method = "lm"`</span>, <span class="in">`method = "aov"`</span> and <span class="in">`method = "rlm"`</span>although several other model fit functions can be expected also to work.</span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>_Some features of the user interface of `stat_multcomp()` may change in future versions of the package._</span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot examples with code</span></span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a>Package <span class="co">[</span><span class="ot">ggpmisc</span><span class="co">](https://docs.r4photobiology.info/ggpmisc/)</span> imports and </span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a>re-exports all definitions from <span class="co">[</span><span class="ot">ggpp</span><span class="co">](https://docs.r4photobiology.info/ggpp/)</span></span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a>as well as from <span class="co">[</span><span class="ot">ggplot2</span><span class="co">](https://ggplot2.tidyverse.org/)</span>, so it is enough to attach explicitly package <span class="co">[</span><span class="ot">ggpmisc</span><span class="co">](https://docs.r4photobiology.info/ggpmisc/)</span> . All three packages are available through CRAN.</span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: false</span></span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggpmisc)</span></span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_bw())</span></span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using default labels</span></span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a>Tukey's method for all pairwise contrasts using _honestly significant differences_.</span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">label.y =</span> <span class="dv">12</span>, </span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>, </span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a>Using Holm's method to adjust _P_-values.</span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">p.adjust.method =</span> <span class="st">"holm"</span>,</span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="dv">12</span>, </span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>, </span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a>Dunnet's method for comparison of each treatment against a control, assumed to be the first level of the factor.</span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">label.y =</span> <span class="dv">25</span>, </span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>,</span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>)</span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a>A staircase of pairwise contrasts with _P_-values adjusted using Holm's method.</span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-216"><a href="#cb20-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-217"><a href="#cb20-217" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-218"><a href="#cb20-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-219"><a href="#cb20-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-220"><a href="#cb20-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">label.y =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">24</span>),</span>
<span id="cb20-221"><a href="#cb20-221" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>,</span>
<span id="cb20-222"><a href="#cb20-222" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb20-223"><a href="#cb20-223" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb20-224"><a href="#cb20-224" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb20-225"><a href="#cb20-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-226"><a href="#cb20-226" aria-hidden="true" tabindex="-1"></a>Tukey's pairwise contrasts using defaults except for the position of the lowermost bar.</span>
<span id="cb20-227"><a href="#cb20-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-230"><a href="#cb20-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-231"><a href="#cb20-231" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-232"><a href="#cb20-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-233"><a href="#cb20-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-234"><a href="#cb20-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">label.y =</span> <span class="dv">25</span>)</span>
<span id="cb20-235"><a href="#cb20-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-236"><a href="#cb20-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-237"><a href="#cb20-237" aria-hidden="true" tabindex="-1"></a>Tukey's pairwise contrasts using defaults and shown with letters.</span>
<span id="cb20-238"><a href="#cb20-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-241"><a href="#cb20-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-242"><a href="#cb20-242" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-243"><a href="#cb20-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-244"><a href="#cb20-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-245"><a href="#cb20-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">label.y =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb20-246"><a href="#cb20-246" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.type =</span> <span class="st">"letters"</span>)</span>
<span id="cb20-247"><a href="#cb20-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-248"><a href="#cb20-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-251"><a href="#cb20-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-252"><a href="#cb20-252" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-253"><a href="#cb20-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-254"><a href="#cb20-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-255"><a href="#cb20-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">colour =</span> <span class="st">"white"</span>, </span>
<span id="cb20-256"><a href="#cb20-256" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.type =</span> <span class="st">"letters"</span>,</span>
<span id="cb20-257"><a href="#cb20-257" aria-hidden="true" tabindex="-1"></a>                <span class="at">adj.method.tag =</span> <span class="dv">0</span>)</span>
<span id="cb20-258"><a href="#cb20-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-259"><a href="#cb20-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-262"><a href="#cb20-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-263"><a href="#cb20-263" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-264"><a href="#cb20-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">size =</span> <span class="fl">2.75</span>) <span class="sc">+</span></span>
<span id="cb20-265"><a href="#cb20-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb20-266"><a href="#cb20-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-267"><a href="#cb20-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-270"><a href="#cb20-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-271"><a href="#cb20-271" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-272"><a href="#cb20-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">size =</span> <span class="fl">2.85</span>,</span>
<span id="cb20-273"><a href="#cb20-273" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="dv">11</span>,</span>
<span id="cb20-274"><a href="#cb20-274" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"text_pairwise"</span>,</span>
<span id="cb20-275"><a href="#cb20-275" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="fl">0.07</span>,</span>
<span id="cb20-276"><a href="#cb20-276" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.digits =</span> <span class="dv">2</span>,</span>
<span id="cb20-277"><a href="#cb20-277" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>) <span class="sc">+</span></span>
<span id="cb20-278"><a href="#cb20-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-279"><a href="#cb20-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-280"><a href="#cb20-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-281"><a href="#cb20-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-284"><a href="#cb20-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-285"><a href="#cb20-285" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-286"><a href="#cb20-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="at">label.type =</span> <span class="st">"letters"</span>,</span>
<span id="cb20-287"><a href="#cb20-287" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"label"</span>,</span>
<span id="cb20-288"><a href="#cb20-288" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>) <span class="sc">+</span></span>
<span id="cb20-289"><a href="#cb20-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb20-290"><a href="#cb20-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-291"><a href="#cb20-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-292"><a href="#cb20-292" aria-hidden="true" tabindex="-1"></a>Numeric _P_-values shown for Dunnet contrasts.</span>
<span id="cb20-293"><a href="#cb20-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-296"><a href="#cb20-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-297"><a href="#cb20-297" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-298"><a href="#cb20-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-299"><a href="#cb20-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-300"><a href="#cb20-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">stage</span>(<span class="at">start =</span> <span class="fu">factor</span>(cyl), </span>
<span id="cb20-301"><a href="#cb20-301" aria-hidden="true" tabindex="-1"></a>                              <span class="at">after_stat =</span> x.right.tip)),</span>
<span id="cb20-302"><a href="#cb20-302" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb20-303"><a href="#cb20-303" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb20-304"><a href="#cb20-304" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="dv">0</span>,</span>
<span id="cb20-305"><a href="#cb20-305" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb20-306"><a href="#cb20-306" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>)</span>
<span id="cb20-307"><a href="#cb20-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-308"><a href="#cb20-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-309"><a href="#cb20-309" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using pre-built labels other than default</span></span>
<span id="cb20-310"><a href="#cb20-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-311"><a href="#cb20-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-314"><a href="#cb20-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-315"><a href="#cb20-315" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-316"><a href="#cb20-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"delta"</span>, <span class="st">"P"</span>)),</span>
<span id="cb20-317"><a href="#cb20-317" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>,</span>
<span id="cb20-318"><a href="#cb20-318" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="dv">11</span>,</span>
<span id="cb20-319"><a href="#cb20-319" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="fl">0.08</span>,</span>
<span id="cb20-320"><a href="#cb20-320" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.digits =</span> <span class="dv">2</span>,</span>
<span id="cb20-321"><a href="#cb20-321" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>) <span class="sc">+</span></span>
<span id="cb20-322"><a href="#cb20-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-323"><a href="#cb20-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-324"><a href="#cb20-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-325"><a href="#cb20-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-328"><a href="#cb20-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-329"><a href="#cb20-329" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-330"><a href="#cb20-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"t"</span>, <span class="st">"P"</span>)),</span>
<span id="cb20-331"><a href="#cb20-331" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="fl">2.75</span>,</span>
<span id="cb20-332"><a href="#cb20-332" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="dv">11</span>,</span>
<span id="cb20-333"><a href="#cb20-333" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="fl">0.08</span>,</span>
<span id="cb20-334"><a href="#cb20-334" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>) <span class="sc">+</span></span>
<span id="cb20-335"><a href="#cb20-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-336"><a href="#cb20-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-337"><a href="#cb20-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-338"><a href="#cb20-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-341"><a href="#cb20-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-342"><a href="#cb20-342" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-343"><a href="#cb20-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-344"><a href="#cb20-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-345"><a href="#cb20-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">stage</span>(<span class="at">start =</span> <span class="fu">factor</span>(cyl), <span class="at">after_stat =</span> x.right.tip),</span>
<span id="cb20-346"><a href="#cb20-346" aria-hidden="true" tabindex="-1"></a>                    <span class="at">label =</span> <span class="fu">after_stat</span>(stars.label)),</span>
<span id="cb20-347"><a href="#cb20-347" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb20-348"><a href="#cb20-348" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb20-349"><a href="#cb20-349" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="dv">0</span>,</span>
<span id="cb20-350"><a href="#cb20-350" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>)</span>
<span id="cb20-351"><a href="#cb20-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-352"><a href="#cb20-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-353"><a href="#cb20-353" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using other aesthetics than the default</span></span>
<span id="cb20-354"><a href="#cb20-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-357"><a href="#cb20-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-358"><a href="#cb20-358" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-359"><a href="#cb20-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">after_stat</span>(p.value) <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb20-360"><a href="#cb20-360" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>,</span>
<span id="cb20-361"><a href="#cb20-361" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="dv">11</span>,</span>
<span id="cb20-362"><a href="#cb20-362" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="fl">0.08</span>,</span>
<span id="cb20-363"><a href="#cb20-363" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.digits =</span> <span class="dv">2</span>,</span>
<span id="cb20-364"><a href="#cb20-364" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>) <span class="sc">+</span></span>
<span id="cb20-365"><a href="#cb20-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-366"><a href="#cb20-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb20-367"><a href="#cb20-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-368"><a href="#cb20-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-369"><a href="#cb20-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-372"><a href="#cb20-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-373"><a href="#cb20-373" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-374"><a href="#cb20-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">after_stat</span>(p.value) <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb20-375"><a href="#cb20-375" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.75</span>,</span>
<span id="cb20-376"><a href="#cb20-376" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.y =</span> <span class="dv">11</span>,</span>
<span id="cb20-377"><a href="#cb20-377" aria-hidden="true" tabindex="-1"></a>                <span class="at">vstep =</span> <span class="fl">0.08</span>,</span>
<span id="cb20-378"><a href="#cb20-378" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.digits =</span> <span class="dv">2</span>,</span>
<span id="cb20-379"><a href="#cb20-379" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> <span class="st">"Dunnet"</span>) <span class="sc">+</span></span>
<span id="cb20-380"><a href="#cb20-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-381"><a href="#cb20-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey90"</span>, <span class="st">"lightblue"</span>)) <span class="sc">+</span></span>
<span id="cb20-382"><a href="#cb20-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-383"><a href="#cb20-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-384"><a href="#cb20-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-387"><a href="#cb20-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-388"><a href="#cb20-388" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-389"><a href="#cb20-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(<span class="fu">after_stat</span>(letters.label))),</span>
<span id="cb20-390"><a href="#cb20-390" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.type =</span> <span class="st">"letters"</span>,</span>
<span id="cb20-391"><a href="#cb20-391" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb20-392"><a href="#cb20-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-393"><a href="#cb20-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-394"><a href="#cb20-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-395"><a href="#cb20-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-396"><a href="#cb20-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-399"><a href="#cb20-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-400"><a href="#cb20-400" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), cty)) <span class="sc">+</span></span>
<span id="cb20-401"><a href="#cb20-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_multcomp</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(<span class="fu">after_stat</span>(letters.label))),</span>
<span id="cb20-402"><a href="#cb20-402" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.type =</span> <span class="st">"letters"</span>,</span>
<span id="cb20-403"><a href="#cb20-403" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb20-404"><a href="#cb20-404" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb20-405"><a href="#cb20-405" aria-hidden="true" tabindex="-1"></a>                <span class="at">adj.method.tag =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-406"><a href="#cb20-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-407"><a href="#cb20-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb20-408"><a href="#cb20-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-409"><a href="#cb20-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-410"><a href="#cb20-410" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb20-411"><a href="#cb20-411" aria-hidden="true" tabindex="-1"></a>Additional examples are available in the documentation of function <span class="in">`stat_multcomp()`</span> and in the <span class="co">[</span><span class="ot">vignette of package 'ggpmisc'</span><span class="co">](https://docs.r4photobiology.info/ggpmisc/articles/model-based-annotations.html#stat_multcomp)</span>.</span>
<span id="cb20-412"><a href="#cb20-412" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0003-3385-972X">
<p>P. J. Aphalo @ ORCID</p>
</a>
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 ISSN 2343-3248 (Helsinki, Finland)
  </li>  
</ul>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="../about/about.html">
<p>© 2015-2023 Pedro J. Aphalo</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>