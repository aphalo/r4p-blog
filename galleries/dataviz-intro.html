<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.544">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pedro J. Aphalo">
<meta name="dcterms.date" content="2023-10-30">
<meta name="keywords" content="research process, design of experiments, data analysis">

<title>Using R for Photobiology - Introduction to Data Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../r4p-favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../r4p-logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Using R for Photobiology</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../posts.html"> <i class="bi bi-newspaper" role="img">
</i> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../pages.html"> <i class="bi bi-file-richtext" role="img">
</i> 
<span class="menu-text">Pages</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../galleries.html"> <i class="bi bi-images" role="img">
</i> 
<span class="menu-text">R gallery</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-packages" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-box-seam" role="img">
</i> 
 <span class="menu-text">R packages</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-r-packages">    
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/"><i class="bi bi-list" role="img">
</i> 
 <span class="dropdown-text">Documentation Index</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://r.r4photobiology.info/"><i class="bi bi-cloud-download" role="img">
</i> 
 <span class="dropdown-text">CRAN-like repository</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/learnrbook/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">learnrbook</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../pages/ggpmisc-intro.html"><i class="bi bi-stack" role="img">
</i> 
 <span class="dropdown-text">Intro <em>‘ggpmisc’, ‘ggpp’ and ‘gginnards’</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ggpmisc/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">ggpmisc</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ggpp/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">ggpp</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/gginnards/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">gginnards</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../pages/r4p-introduction.html"><i class="bi bi-sun" role="img">
</i> 
 <span class="dropdown-text">Intro <em>R for Photobiology Suite</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiology/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ggspectra/"><i class="bi bi-layers" role="img">
</i> 
 <span class="dropdown-text">ggspectra</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyWavebands/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiologyWavebands</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyInOut/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiologyInOut</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/ooacquire/"><i class="bi bi-rulers" role="img">
</i> 
 <span class="dropdown-text">ooacquire</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/rOmniDriver/"><i class="bi bi-rulers" role="img">
</i> 
 <span class="dropdown-text">rOmniDriver</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyPlants/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">photobiologyPlants</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyLamps/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologyLamps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyLEDs/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologyLEDs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologySun/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologySun</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologyFilters/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologyFilters</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/photobiologySensors/"><i class="bi bi-archive" role="img">
</i> 
 <span class="dropdown-text">photobiologySensors</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../pages/packages-status.html"><i class="bi bi-check-all" role="img">
</i> 
 <span class="dropdown-text">Checks and issues</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-books" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Books</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-books">    
        <li>
    <a class="dropdown-item" href="https://www.learnr-book.info/"><i class="bi bi-book" role="img">
</i> 
 <span class="dropdown-text">Book <em>Learn R - As a Language</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pages/beyond-the-visible.html"><i class="bi bi-book" role="img">
</i> 
 <span class="dropdown-text">Handbook <em>Beyond the Visible</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pages/r4p-book.html"><i class="bi bi-book-half" role="img">
</i> 
 <span class="dropdown-text">Book <em>R for Photobiology</em></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-person" role="img">
</i> 
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../about/help.html"><i class="bi bi-question-square" role="img">
</i> 
 <span class="dropdown-text">Site Help</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../about/about.html"><i class="bi bi-pc-display" role="img">
</i> 
 <span class="dropdown-text">About <em>this site</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../about/pedro.html"><i class="bi bi-person" role="img">
</i> 
 <span class="dropdown-text">About <em>Pedro J. Aphalo</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/aphalo/r4p-blog/"><i class="bi bi-github" role="img">
</i> 
 <span class="dropdown-text">Source of <em>this site</em> at GitHub</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-rss-feeds" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text">RSS feeds</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-rss-feeds">    
        <li>
    <a class="dropdown-item" href="../posts.xml"><i class="bi bi-newspaper" role="img">
</i> 
 <span class="dropdown-text">Blog RSS feed</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pages.xml"><i class="bi bi-file-richtext" role="img">
</i> 
 <span class="dropdown-text">Pages RSS feed</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../galleries.xml"><i class="bi bi-images" role="img">
</i> 
 <span class="dropdown-text">Gallery RSS feed</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Introduction to Data Visualization</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Using R with package ‘ggplot2’ and extensions</p>
                                <div class="quarto-categories">
                <div class="quarto-category">data visualization</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Pedro J. Aphalo </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2023-10-30</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">2023-11-17</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">Abstract</div>
      An introduction to data visualization using R. The same data are plotted in different ways to demonstrate how different approaches to plotting emphasize different aspects of the data. Plots suitable for different audiences are also created. The source code for all examples is included in the page.
    </div>
  </div>

  <div>
    <div class="keywords">
      <div class="block-title">Keywords</div>
      <p>research process, design of experiments, data analysis</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#uses-of-graphical-displays-of-data" id="toc-uses-of-graphical-displays-of-data" class="nav-link" data-scroll-target="#uses-of-graphical-displays-of-data">Uses of graphical displays of data</a></li>
  <li><a href="#continuous-and-discrete-variables" id="toc-continuous-and-discrete-variables" class="nav-link" data-scroll-target="#continuous-and-discrete-variables">Continuous and discrete variables</a></li>
  <li><a href="#plotting-data-summaries" id="toc-plotting-data-summaries" class="nav-link" data-scroll-target="#plotting-data-summaries">Plotting data summaries</a></li>
  <li><a href="#annotations-and-data-labels" id="toc-annotations-and-data-labels" class="nav-link" data-scroll-target="#annotations-and-data-labels">Annotations and data labels</a></li>
  <li><a href="#number-of-observations" id="toc-number-of-observations" class="nav-link" data-scroll-target="#number-of-observations">Number of observations</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a>
  <ul class="collapse">
  <li><a href="#growth-of-orange-trees" id="toc-growth-of-orange-trees" class="nav-link" data-scroll-target="#growth-of-orange-trees">Growth of orange trees</a>
  <ul class="collapse">
  <li><a href="#scatter-plot" id="toc-scatter-plot" class="nav-link" data-scroll-target="#scatter-plot">Scatter plot</a></li>
  <li><a href="#line-plot" id="toc-line-plot" class="nav-link" data-scroll-target="#line-plot">Line plot</a></li>
  <li><a href="#combined-scatter-and-line-plot" id="toc-combined-scatter-and-line-plot" class="nav-link" data-scroll-target="#combined-scatter-and-line-plot">Combined scatter and line plot</a></li>
  <li><a href="#plot-of-regression-line" id="toc-plot-of-regression-line" class="nav-link" data-scroll-target="#plot-of-regression-line">Plot of regression line</a></li>
  </ul></li>
  <li><a href="#height-of-birch-seedlings" id="toc-height-of-birch-seedlings" class="nav-link" data-scroll-target="#height-of-birch-seedlings">Height of birch seedlings</a>
  <ul class="collapse">
  <li><a href="#dot-plot" id="toc-dot-plot" class="nav-link" data-scroll-target="#dot-plot">Dot plot</a></li>
  <li><a href="#plots-of-means-and-cl" id="toc-plots-of-means-and-cl" class="nav-link" data-scroll-target="#plots-of-means-and-cl">Plots of means and CL</a></li>
  <li><a href="#simple-column-plot" id="toc-simple-column-plot" class="nav-link" data-scroll-target="#simple-column-plot">Simple column plot</a></li>
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram">Histogram</a></li>
  <li><a href="#box-and-whiskers-plot" id="toc-box-and-whiskers-plot" class="nav-link" data-scroll-target="#box-and-whiskers-plot">Box and whiskers plot</a></li>
  <li><a href="#density-plot" id="toc-density-plot" class="nav-link" data-scroll-target="#density-plot">Density plot</a></li>
  <li><a href="#violin-plot" id="toc-violin-plot" class="nav-link" data-scroll-target="#violin-plot">Violin plot</a></li>
  <li><a href="#bee-swarm-plot" id="toc-bee-swarm-plot" class="nav-link" data-scroll-target="#bee-swarm-plot">Bee swarm plot</a></li>
  <li><a href="#jittered-dot-plot-and-boxplot" id="toc-jittered-dot-plot-and-boxplot" class="nav-link" data-scroll-target="#jittered-dot-plot-and-boxplot">Jittered dot plot and boxplot</a></li>
  <li><a href="#beeswarm-violin-and-box-plots-combined" id="toc-beeswarm-violin-and-box-plots-combined" class="nav-link" data-scroll-target="#beeswarm-violin-and-box-plots-combined">Beeswarm, violin and box plots combined</a></li>
  </ul></li>
  <li><a href="#dry-mass-of-stems-and-roots-of-birch-seedlings" id="toc-dry-mass-of-stems-and-roots-of-birch-seedlings" class="nav-link" data-scroll-target="#dry-mass-of-stems-and-roots-of-birch-seedlings">Dry mass of stems and roots of birch seedlings</a>
  <ul class="collapse">
  <li><a href="#composition-columns" id="toc-composition-columns" class="nav-link" data-scroll-target="#composition-columns">“Composition” columns</a></li>
  <li><a href="#side-by-side-columns" id="toc-side-by-side-columns" class="nav-link" data-scroll-target="#side-by-side-columns">Side-by-side columns</a></li>
  </ul></li>
  <li><a href="#allometric-relationships-of-birch-seedlings" id="toc-allometric-relationships-of-birch-seedlings" class="nav-link" data-scroll-target="#allometric-relationships-of-birch-seedlings">Allometric relationships of birch seedlings</a>
  <ul class="collapse">
  <li><a href="#scatter-plot-1" id="toc-scatter-plot-1" class="nav-link" data-scroll-target="#scatter-plot-1">Scatter plot</a></li>
  <li><a href="#rug-plot" id="toc-rug-plot" class="nav-link" data-scroll-target="#rug-plot">Rug plot</a></li>
  <li><a href="#d-summaries-and-centroids" id="toc-d-summaries-and-centroids" class="nav-link" data-scroll-target="#d-summaries-and-centroids">2D summaries and centroids</a></li>
  <li><a href="#d-density" id="toc-d-density" class="nav-link" data-scroll-target="#d-density">2D density</a></li>
  <li><a href="#regression-line" id="toc-regression-line" class="nav-link" data-scroll-target="#regression-line">Regression line</a></li>
  </ul></li>
  <li><a href="#other-plot-examples" id="toc-other-plot-examples" class="nav-link" data-scroll-target="#other-plot-examples">Other plot examples</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><a href="../index.html">Index to other pages at this web site</a>, including some describing additional types of plots.</p>
<p><a href="../ips-003.html">Index of material at this site for course IPS-003</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
IPS-003
</div>
</div>
<div class="callout-body-container callout-body">
<p>In Topic 2 the emphasis of the class was on the usual approaches used in scientific journals when reporting results from molecular biology studies. I will keep the focus in this class much broader, away from the nitty-gritty details and focusing on the different types of plots that can be created. Putting more emphasis on the properties of the data than in their origin, and also considering the aims that we may have when plotting data.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Package ‘ggpp’ version
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Examples make use of an updated version of package ‘ggpp’ (version 0.5.5), now available from CRAN.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">packageVersion</span>(<span class="st">"ggpp"</span>) <span class="sc">&lt;</span> <span class="st">"0.5.5"</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Please, update package 'ggpp' before running the code examples."</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">packageVersion</span>(<span class="st">"ggpmisc"</span>) <span class="sc">&lt;</span> <span class="st">"0.5.4"</span>) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Please, update package 'ggpmisc' before running the code examples."</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<p>Many extensions to package ‘ggplot2’ are available through CRAN repository, making possible the creation additional types of plots using the same approach. Many, but not all, of these packages are listed in a <a href="https://exts.ggplot2.tidyverse.org/gallery/">web page</a> with links to documentation.</p>
<p>All the figures in this page have been created with R and packages ‘ggplot2’, ‘ggpmisc’, ‘ggbeeswarm’ and ‘ggdensity’. Package ‘lubridate’ is used for conversion of times and dates from character strings.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The code used to create the plots is “folded” or hidden behind a triangle followed by the word “code”. Click on them to make the code visible.</p>
<p><strong>The code for loading of packages from the library is below, and needs to be run before any other code examples.</strong></p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdensity)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_set(theme_classic(12))</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="uses-of-graphical-displays-of-data" class="level2">
<h2 class="anchored" data-anchor-id="uses-of-graphical-displays-of-data">Uses of graphical displays of data</h2>
<p>We can distinguish two broad uses of data visualizations: 1) data exploration and analysis by a researcher or group of researchers, and 2) communication of results to the scientific community, stakeholders, decision makers or the geenral public. The difference among plots prepared for different purposes and audiences is mainly in the degree of complexity that can be expected to be understandable and in how aesthetically polished is the plot is.</p>
<div class="callout-attention">
<p>When we prepare a text for publication we spend time in planing how to best communicate our message, then in writing a draft, and in revising this draft, usually several times, until it is ready for submission. The same approach is the best also when producing plots for publication.</p>
<p>As with text, asking other people to study and comment on the figures we create is important. A well designed data visualization can make the difference in the impact (number of times cited) of a publication.</p>
</div>
</section>
<section id="continuous-and-discrete-variables" class="level2">
<h2 class="anchored" data-anchor-id="continuous-and-discrete-variables">Continuous and discrete variables</h2>
<p>Some variables are inherently discontinuous, such as counts. For example, number of germinated seeds, number of plants of a given species present in plot, etc. Other variables are inherently continuous, like temperature. Even if temperature is continuous, if we grow a group of plants at 16 C and another group at 21 C, we force temperature to behave as discrete.</p>
</section>
<section id="plotting-data-summaries" class="level2">
<h2 class="anchored" data-anchor-id="plotting-data-summaries">Plotting data summaries</h2>
<p>Means, trimmed means, medians, standard errors, standard deviations, variances, linear regressions, non-linear regressions, quantile regression, smoothing splines, interpolating splines, empirical density functions in 1D or 2D.</p>
</section>
<section id="annotations-and-data-labels" class="level2">
<h2 class="anchored" data-anchor-id="annotations-and-data-labels">Annotations and data labels</h2>
<p>Annotations and data labels can be text, icons, small plots, small tables, etc. The difference is that annotations refer to the whole plot and data labels to individual observations, or individualy plotted summaries.</p>
</section>
<section id="number-of-observations" class="level2">
<h2 class="anchored" data-anchor-id="number-of-observations">Number of observations</h2>
<p>Different types of plots are suitable depending on the number of observations. We can plot individual observations up to a point. In all cases we need to make sure that if we plot individual observations they are all visible. The number of observations and how clumped together they are can be decisive when chosing the type of plot or data visualization to use.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>With few observations a <em>dot plot</em>, or variations using <em>jitter</em> to prevent overlaps, work usually very well. With more than 10-15 observations a <em>boxplot</em> or <em>beeswarm plot</em> can be used and is usually preferable. With 20 or more observations a <em>violin plot</em> can be good. These are all “rules of thumb” that need to be adjusted using common sense based on how the values are grouped and how they may overlap.</p>
</div>
</div>
</section>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<section id="growth-of-orange-trees" class="level2">
<h2 class="anchored" data-anchor-id="growth-of-orange-trees">Growth of orange trees</h2>
<p>Data set <code>Orange</code>, included in R, contains growth measurements on five orange trees. It contains a continuous response variable (trunk circumference) and one continuous explanatory variable (date). (See <code>help(Orange)</code> in R for additional details.)</p>
<section id="scatter-plot" class="level3">
<h3 class="anchored" data-anchor-id="scatter-plot">Scatter plot</h3>
<p>In this case it is clear which of the variables should be mapped to <em>x</em> and <em>y</em>.</p>
<p>Here we plot observations for each tree individually. This emphasizes the differences among trees. These are repeated measurements on the same trees, but even with a different point <em>shape</em> for each tree, it is rather difficult to assess growth, which is the most interesting feature of the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Orange)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> Tree, <span class="at">linetype =</span> Tree)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Trunk circumference (mm)"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="line-plot" class="level3">
<h3 class="anchored" data-anchor-id="line-plot">Line plot</h3>
<p>Here we connect observations with lines. This emphasizes the growth of individual trees and how it differs among trees.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> Tree, <span class="at">linetype =</span> Tree)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combined-scatter-and-line-plot" class="level3">
<h3 class="anchored" data-anchor-id="combined-scatter-and-line-plot">Combined scatter and line plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> Tree, <span class="at">linetype =</span> Tree)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Plot observations and summaries, joining the means with a line. Playing with the choice of colours, line width and size of points we can vary the relative emphasis given to individual observations and means.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree), <span class="at">colour =</span> <span class="st">"gray70"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A few tweaks to the graphic design and the impression the figure gives changes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">fun =</span> mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>, <span class="at">fun.data =</span> mean_se, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Show only means and standard errors. A very frequently used approach. As Mikael told in Topic 2 this approach is not the best when the means are computed from a small number of observations. However, plotting only means and standard deviations makes plots simpler, and can be a good approach for a talk as opposed to a scientific journal.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-of-regression-line" class="level3">
<h3 class="anchored" data-anchor-id="plot-of-regression-line">Plot of regression line</h3>
<p>Showing only the fitted regression line provides usually too little information.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Showing observations together with a fitted smooth curve can be a good approach in some cases. Here it does not work very well.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Using a logarithmic transformation emphasizes the relative growth rate, i.e., the growth rate relative to the curent size of the plant. We fit a second degree polynomial.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Instead of a polynomial we can fit a smoother or spline, which is more “flexible”.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> loess, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also combine means and standard errors with a linear regression.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>))) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The figure above seems at first sight fine, but there is a repeating pattern in time. So we label the means with the month of the year to look for an explanation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>))) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">label =</span> month.abb[<span class="fu">month</span>(Date)]), </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">y =</span> <span class="dv">30</span>, <span class="at">x =</span> <span class="dv">0</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">direction =</span> <span class="st">"split"</span>), </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-14-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>Orange</code> data set included in R includes only <code>age</code> in days, but the help page gives the starting date. Reconstructing the dates in this case was important to understand the growth of the trees as it allowed us to distinguish measurements at different times of the year. This is crucial as with most perennial plants growth is fast only during the growing season.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions to think about
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Which of the plots above do you think is most informative?</li>
<li>Which of the plots would you prefer to see in a talk?</li>
<li>Which of the plots would be best for a scientific article?`</li>
<li>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</li>
</ol>
</div>
</div>
</section>
</section>
<section id="height-of-birch-seedlings" class="level2">
<h2 class="anchored" data-anchor-id="height-of-birch-seedlings">Height of birch seedlings</h2>
<p>Time ago in an experiment we measured a large number of tree seedlings. This data set contrasts with the one used above. While above we had data for five trees, here we have data for 350 one-summer-old tree seedlings. Measurements are all at a single time point, but different groups of seedlings were grown under different conditions. The data set is included in R package ‘ggpp’ (&gt;= 0.5.5).</p>
<section id="dot-plot" class="level3">
<h3 class="anchored" data-anchor-id="dot-plot">Dot plot</h3>
<p>A simple dot plot cannot contain many observations before points start overlapping. The plot below, even when using transparency, is nearly impossible to read usefully.-</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Adding <em>jitter</em> we randomly spread the points sideways, which helps prevent the majority of the overlaps. However, as we will see below, this works rather well, but there are other options that can make the information easier to read from the plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plots-of-means-and-cl" class="level3">
<h3 class="anchored" data-anchor-id="plots-of-means-and-cl">Plots of means and CL</h3>
<p>In publications plots like the one below are rather common. They are easy to read, but discard quite a lot of information. Confidence limits, computed in the usual way, are informative as long as the distribution is symmetrical and close to the Normal. In this case we use <em>P</em> = 0.95, so we read these bars as indicating that there is a high probability that the true (whole-population) mean height falls within the boundaries of the bars.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">npcx =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">npcy =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-17-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the plot above the height scale starts at 60 cm. Most members of the scientific community can be excepted, at least if given enough time, to read the plot correctly. In contrast, the general public in many countries is likely to misinterpret a plot like this getting the impression that there is a huge difference in height btween the two groups of seedlings. So, even if it leaves a lot empty white space, the version of the plot with the <em>y</em> axis starting at zero can be preferable.</p>
<p>The first impression is very different, even for someone experienced. The CLs that looked quite large now look tiny. Of course if we use the axis scale, we realize in both cases that the whole range of the CLs is about 3 cm.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">npcx =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">npcy =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-18-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even more common than CLs for error bars (in black) is plotting of standard errors as error bars (in blue). With a large number of observations, CLs bars are about twice as long than SE bars, otherwise, even longer. (Nobody I know would use a figure like this except as here to demonstrate the difference.)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.data =</span> mean_se, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">npcx =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">npcy =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-19-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>We can have more than one grouping and more than two categories per grouping.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Container, <span class="at">shape =</span> Density)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-20-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-21-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simple-column-plot" class="level3">
<h3 class="anchored" data-anchor-id="simple-column-plot">Simple column plot</h3>
<p>Column plots are not very popular these days, but they provide and effective way for showing differences when zero is a meaningful minimum value, like with mass. They emphasize the overall size more than the differences in size. Depending on the quantity and aims of a study the effect relative to the whole size, maybe be more interesting than the absolute size of the effect.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-22-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Next we will create several visualizations that inform us about the properties of the data set. In general in recent years there has been an increase in the use of more informative data visualizations in scientific research, in part because of the more widespread recognition of the weaknesses of showing only means and error bars, but also because the plotting of data in more elaborate ways has become easier with increasingly powerful computers and free software like R.</p>
<p>We next look at histograms, which have been in use for a very long time, and have different limitations.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>birch.df</code> data set included in R package ‘ggpp’ contains additional variables than those plotted above.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions to think about
</div>
</div>
<div class="callout-body-container callout-body">
<p>The plots above mainly describe the position of the center of the data, and a summary version of the variation.</p>
<ol type="1">
<li>Which of the plots above do you think is most informative about the height and dry mass of the seedlings?</li>
<li>Which of the plots would you prefer to see in a talk?</li>
<li>Which of the plots would be best for a scientific article?`</li>
<li>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</li>
</ol>
</div>
</div>
</section>
<section id="histogram" class="level3">
<h3 class="anchored" data-anchor-id="histogram">Histogram</h3>
<p>Although histograms are usually plotted as columns, they are very different to the column plots above. In an histogram the columns do not represent summaries of a measured variable individually, they describe the absolute number (or the relative number) of observations within different ranges of values of the measured variable.</p>
<p>A histogram in this case provides a simple way of describing the number of seedlings within each size <em>bin</em> or range of heights. From this figure we can read that the largest number of seedlings are about 75 cm tall. We can also see that the shape is asymmetrical with more very short seedlings than very tall ones.</p>
<p><strong>A “meaningful” box blot can only be created from a fairly large number of replicate observations.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-23-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>By changing <code>color</code> and <code>fill</code> we can emphasize the <em>bins</em> used for counting the observations.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-24-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Two different kinds of histograms can be created. As above using <em>counts</em> or <em>frequencies</em>, or using <em>density</em> where density is obtained by dividing the count for each bin by the total count. In other words, so that the sum of the columns is equal to one. The shape remains unchanged.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-25-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The seedlings were grown in two types of tray, with large and small “cells” for the soil, or containers. We can <em>stack</em> two histograms, one on top of the other. The upper edge is unchanged from above, but each column shows separately the counts for each container type.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-26-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also make the bars semi-transparent and overlap the histograms. As one could expect, the seedlings grown in larger containers as taller. The whole distribution of sizes is shifted by some 15 cm. In this histogram bins are 5cm wide. This plot emphasizes the difference in height between the two groups.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-27-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Plots with panels that share the same axis scales can be a very effective way of visualizing data, and as each panel contains a simpler plot they do not necessarily occupy more space in a page. This plot emphasizes the “apparent’ different in shape of the two height distributuions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-28-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As we are plotting data for height, flipping the <em>x</em> and <em>y</em> axes can make reading the figure more intuitive,</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-29-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout_warning">
<p>How a histogram looks depends on the width and position of the bins used to count observations. Histograms are still used very frequently, but their biggest advantage, the easy of computation, has been removed by modern computers. So, I do no longer use them. It is important, however, to understand how they work.</p>
<p>The same plot as above after increasing bin width from 5 cm to 10 cm.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-30-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>By sligtly shifting the center of the bins along <em>x</em>, the shape of the histogram changes so that the shape becomes more similar between the two containers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">center =</span> <span class="fl">72.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-31-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Take home message:</strong> Extreme care is needed to avoid over-interpreting histograms!</p>
</div>
</section>
<section id="box-and-whiskers-plot" class="level3">
<h3 class="anchored" data-anchor-id="box-and-whiskers-plot">Box and whiskers plot</h3>
<p>Box and whiskers plots, boxplots for short, are another easy-to-compute type of plots good for describing the spread and distribution of observations. The thick line in the middle is the median, and the ends of the box the quatiles. In other words in the plot below, half of the observation are above the median and half of them below. In addition half of the observations fall within the range of height delimited by the box. The whiskers, in the absence of <em>outliers</em>, give the range of the whole data set. There are different ways determining which observations are “unusual”, one is making the whiskers at most 1.5 times the size of the box, and showing the outliers as points.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">"grey95"</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-32-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the plot above all outliers are small and the lower whisker is longer than the upper one. This indicates, as we saw with the histograms, that the distributions have a long left tail, i.e., more very short seedlings than could be expected for a symmetric distribution.</p>
<p>Notches are sometimes added to boxplots, they are an <em>approximate</em> way of testing for significant differences between the medians of groups. Here, that the ends of the notches for the two groups do not overlap suggests that the median height of plants grown in larger containers is larger.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey95"</span>) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-33-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Boxplots drawn with fewer than 10 or even 15 observations per boxplot should be avoided. They can be very difficult to interpret, as with few observations differences in the lengths of whiskers and outliers appear simply because of the sampling process and are thus not informative about the sampled population.</p>
<p>As with histograms, the values used in boxplots are rather easy to calculate. This advantage has been made irrelevant by modern computers. However, they remain a useful approach when the number of observations is rather large.</p>
<p><strong>Take home message:</strong> Boxplots are in my opinion frequently misused when simple dot plots would be more informative.</p>
</div>
</div>
</section>
<section id="density-plot" class="level3">
<h3 class="anchored" data-anchor-id="density-plot">Density plot</h3>
<p>We plotted above a histogram using density. With a procedure that computes a local density without using discrete bins, but instead a continuous smoother, we obtain a more consistent estimate of density. Still, the shape depends to some extent on the “flexibility” of the smoother user.</p>
<p>In this section we draw density plots equivalent to the histograms above.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density (area = 1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-34-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>When plotting densities (empirical density function or EDF) separately for each container size, we get two very similar distributions shifted by about 12 cm. Thus the differences between the two equivalent histograms can be attributed to the procedure used to construct the histograms rather than to the data themselves.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density (area = 1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-35-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We here overlap the density curve on top of the histograms to compare them.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey70"</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">outline.type =</span> <span class="st">"upper"</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density (area = 1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-36-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Take hopme message:</strong> In most situations smooth density plots are preferable to histograms, with the caveat, that fewer people are familiar with them.</p>
</div>
</div>
</section>
<section id="violin-plot" class="level3">
<h3 class="anchored" data-anchor-id="violin-plot">Violin plot</h3>
<p>Whe can think of violin plots as density plots with a layout similar to box plots. There is a variant, not shown, where half violins are plotted and combined with a different “half plot”.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-37-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can add lines for quantiles, and a fill.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">fill =</span> <span class="st">"grey98"</span>) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-38-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To demostrate this, we next plot together boxplots and violin plots.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">"grey95"</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-39-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As above, we can add notches to the box plots.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Container), <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>), </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-40-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Take home message:</strong> Violin plots are a handy way of plotting density distributions for different groups side by side for comparison. Specially when we have several groups they are very useful. As with density plots, several replicate observations (&gt; 10 to 15 per violin) are needed for fit the densities in violin plots.</p>
</div>
</div>
</section>
<section id="bee-swarm-plot" class="level3">
<h3 class="anchored" data-anchor-id="bee-swarm-plot">Bee swarm plot</h3>
<p>If we spread the actual observations so as to approximatelly fill a violin plot we get what could be called a <em>quasirandom</em> bee swarm plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-41-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This type of plot can be effectively combined with a violin plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Container), <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-42-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A more compact version of a <em>bee swarm</em> plot is also possible.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-43-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As well as a one-sided version, that we can combine with a boxplot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="at">side =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-44-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="jittered-dot-plot-and-boxplot" class="level3">
<h3 class="anchored" data-anchor-id="jittered-dot-plot-and-boxplot">Jittered dot plot and boxplot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density, <span class="at">colour =</span> Density)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>, <span class="at">x =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-45-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="beeswarm-violin-and-box-plots-combined" class="level3">
<h3 class="anchored" data-anchor-id="beeswarm-violin-and-box-plots-combined">Beeswarm, violin and box plots combined</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density, <span class="at">colour =</span> Density, <span class="at">group =</span> Density)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>), </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-46-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The data originate from many seedlings, and several variables have been measured. This means that there are many different ways in which we can plot them emphasizing different features and relationships.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question to think about
</div>
</div>
<div class="callout-body-container callout-body">
<p>Considering plots that describe the distribution and variation in the data, please answer the following questions.</p>
<ol type="1">
<li>Which of the plots above do you think is most informative?</li>
<li>Which of the plots would you prefer to see in a talk?</li>
<li>Which of the plots would be best for a scientific article?`</li>
<li>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</li>
</ol>
</div>
</div>
</section>
</section>
<section id="dry-mass-of-stems-and-roots-of-birch-seedlings" class="level2">
<h2 class="anchored" data-anchor-id="dry-mass-of-stems-and-roots-of-birch-seedlings">Dry mass of stems and roots of birch seedlings</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(birch.df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Container" "Density"   "block"     "height"    "diameter"  "dwstem"   
[7] "dwroot"    "healthy"  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>stem.df <span class="ot">&lt;-</span> birch.df[ , <span class="fu">c</span>(<span class="st">"Container"</span>, <span class="st">"Density"</span>,   <span class="st">"block"</span>, <span class="st">"dwstem"</span>)]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stem.df)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"dry.weight"</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>stem.df<span class="sc">$</span>Part <span class="ot">&lt;-</span> <span class="st">"stem"</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>root.df <span class="ot">&lt;-</span> birch.df[ , <span class="fu">c</span>(<span class="st">"Container"</span>, <span class="st">"Density"</span>,   <span class="st">"block"</span>, <span class="st">"dwroot"</span>)]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(root.df)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"dry.weight"</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>root.df<span class="sc">$</span>Part <span class="ot">&lt;-</span> <span class="st">"root"</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>birch_dw.df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stem.df, root.df)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>birch_dw.df<span class="sc">$</span>Part <span class="ot">&lt;-</span> <span class="fu">factor</span>(birch_dw.df<span class="sc">$</span>Part, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"stem"</span>, <span class="st">"root"</span>))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(stem.df, root.df)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(birch_dw.df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Container"  "Density"    "block"      "dry.weight" "Part"      </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch_dw.df, </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> dry.weight <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density, <span class="at">fill =</span> Part)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>, <span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack_minmax</span>()) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-48-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="composition-columns" class="level3">
<h3 class="anchored" data-anchor-id="composition-columns">“Composition” columns</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch_dw.df, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> dry.weight <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density, <span class="at">fill =</span> Part)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry mass allocation (/1)"</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-49-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="side-by-side-columns" class="level3">
<h3 class="anchored" data-anchor-id="side-by-side-columns">Side-by-side columns</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch_dw.df, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> dry.weight <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density, <span class="at">fill =</span> Part)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>, <span class="at">fun.data =</span> mean_se, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.67</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-50-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question to think about
</div>
</div>
<div class="callout-body-container callout-body">
<p>Considering plots that describe the dry mass of the seedlings, please answer the following questions.</p>
<ol type="1">
<li>Which of the plots above do you think is most informative?</li>
<li>Which of the plots would you prefer to see in a talk?</li>
<li>Which of the plots would be best for a scientific article?`</li>
<li>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</li>
</ol>
</div>
</div>
</section>
</section>
<section id="allometric-relationships-of-birch-seedlings" class="level2">
<h2 class="anchored" data-anchor-id="allometric-relationships-of-birch-seedlings">Allometric relationships of birch seedlings</h2>
<p>In the <code>birch.df</code> used above, we find multiple measured continuous variables. In this case, we will plot one continuous variable against another, and in many cases add a grouping with a categorical variable. In some cases, there is no clear criterion for the assigment of variables to <em>x</em> and <em>y</em> as both are response variables subject to biological variability and measurement errors.</p>
<section id="scatter-plot-1" class="level3">
<h3 class="anchored" data-anchor-id="scatter-plot-1">Scatter plot</h3>
<p>A plot with individual observations represented by points is called a scatter plot when both varaibles are continuous (points are scattered in the plotting area along both axes) and a dot plot when one of the variables is discrete and points are aligned by group.</p>
<p>Transparency is a way of making the overlaps among points visible.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> diameter, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="st">"Root collar diameter (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-51-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Using “facets” or panels with consistent scales is an alternative approach. The plot above emphasizes that the relationship between the variables seems to be the same in both groups. The figure below better highlights the differences is size and de-emphasizes the averlap.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> diameter, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="st">"Root collar diameter (mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-52-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Based of first principles, we can assume that the cross section area of base of the stem would relate closely to the size of the whole seedling measured as dry mass. We plot the same plot after transforming diameter into cross-section area. The curvature of the cloud of points, seen above, vanishes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-53-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rug-plot" class="level3">
<h3 class="anchored" data-anchor-id="rug-plot">Rug plot</h3>
<p>Rug lines, like the threads at the edge of a rug, are plotted on the edges and follow on one of <em>x</em> or <em>y</em> at a time. By default, for each observation, one segment is drawn on the left edge and another one on the bottom edge.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-54-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="d-summaries-and-centroids" class="level3">
<h3 class="anchored" data-anchor-id="d-summaries-and-centroids">2D summaries and centroids</h3>
<p>We mark the point given by <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> with a <strong>+</strong>. We also add as an annotation the result from a correlation test.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">shape =</span> <span class="st">"+"</span>, <span class="at">size =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">geom =</span> <span class="st">"rug"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_correlation</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"R"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-55-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="d-density" class="level3">
<h3 class="anchored" data-anchor-id="d-density">2D density</h3>
<p>As we have two response variables, each subjected to variation, it is informative to estimate the empirical density function in two dimensions (a 2D EDF). In other words for each combination of <em>x</em> and <em>y</em> values we obtain a density estimate. We represent this density on a hypothetical <em>z</em> axis, that we represent with isolines. The traditional approach makes these lines equidistant.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">adjust =</span> <span class="fl">0.66</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-56-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>An alternative, and more easily interpretable approach sets the isolines based on specific probabilities. Here the central dark area includes 50% of the density and is thus equivalent to the box in a box plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_hdr</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-57-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We mark the point given by the medians of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> with a <strong>+</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_hdr</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">shape =</span> <span class="st">"+"</span>, <span class="at">size =</span> <span class="dv">7</span>, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fun =</span> median) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-58-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The equivalent of a 2D histogram is based on counts in 2D bins. The bins can be square shaped or hexagonal.</p>
</section>
<section id="regression-line" class="level3">
<h3 class="anchored" data-anchor-id="regression-line">Regression line</h3>
<p>As we will see later, fitting regression lines or other statistical models is a very powerful way of describing observations as well as for prediction. Here, as both variables, mapped to <em>x</em> and <em>y</em>, are subject to error variation we need to use a special kind of regression, <em>major axis regression</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>)), <span class="at">vstep =</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-59-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A regresion jointly fitted to all data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>)), <span class="at">vstep =</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Container), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-60-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here, separate lines for each container size and each density.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Density)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.y =</span> <span class="st">"bottom"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.75</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-61-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question to think about
</div>
</div>
<div class="callout-body-container callout-body">
<p>Considering plots that describe the relationship between height and dry mass, please answer the following questions.</p>
<ol type="1">
<li>Which of the plots above do you think is most informative?</li>
<li>Which of the plots would you prefer to see in a talk?</li>
<li>Which of the plots would be best for a scientific article?`</li>
<li>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why not linear regression?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here using linear regression would be wrong!</p>
<p>The lines in this first plot are linear regressions of <em>y</em> on <em>x</em>, assuming <em>x</em> (dry mass) is measured without error.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Density)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.y =</span> <span class="st">"bottom"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.75</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-62-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The lines in this first plot are linear regressions of <em>x</em> on <em>y</em>, assuming <em>y</em> (height) is measured without error.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Density)) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">orientation =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.y =</span> <span class="st">"bottom"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>, <span class="at">orientation =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.75</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dataviz-intro_files/figure-html/unnamed-chunk-63-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The lines are drastically different!</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Friends don’t let friends make bad graphs
</div>
</div>
<div class="callout-body-container callout-body">
<p>A nice set of paired good and bad plots.</p>
<p><a href="https://github.com/cxli233/FriendsDontLetFriends#friends-dont-let-friends-make-bad-graphs">Friends don’t let friends…</a></p>
</div>
</div>
</section>
</section>
<section id="other-plot-examples" class="level2">
<h2 class="anchored" data-anchor-id="other-plot-examples">Other plot examples</h2>
<p>These links are here in case you would like to see some additional possibilities, or as a cookbook of code examples if you need for reports or the thesis.</p>
<p><a href="../galleries/quadrant-volcano-plots.html">Quadrant and volcano plots</a> are a special type of scatter plots.</p>
<p><a href="../galleries/bar-col-plots.html">Data labels in bar and column plots</a> a few examples using package ‘ggpp’.</p>
<p><a href="../index.html">Index to other pages at this web site</a>, including some describing additional types of plots and other uses of R.</p>
<p><a href="../ips-003.html">Index of material at this site for course IPS-003</a></p>


<!-- -->

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb67" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Introduction to Data Visualization"</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Using R with package 'ggplot2' and extensions"</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Pedro J. Aphalo"</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-10-30</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> 2023-11-17</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [data visualization]</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span><span class="co"> [research process, design of experiments, data analysis]</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="co">    mermaid:</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co">      theme: neutral</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> </span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co">  An introduction to data visualization using R. The same data are plotted in different ways to demonstrate how different approaches to plotting emphasize different aspects of the data. Plots suitable for different audiences are also created. The source code for all examples is included in the page.</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Index to other pages at this web site</span><span class="co">](../index.qmd)</span>, including some describing additional types of plots.</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Index of material at this site for course IPS-003</span><span class="co">](../ips-003.qmd)</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># IPS-003</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>In Topic 2 the emphasis of the class was on the usual approaches used in scientific journals when reporting results from molecular biology studies. I will keep the focus in this class much broader, away from the nitty-gritty details and focusing on the different types of plots that can be created. Putting more emphasis on the properties of the data than in their origin, and also considering the aims that we may have when plotting data.</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Package 'ggpp' version</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>**Examples make use of an updated version of package 'ggpp' (version 0.5.5), now available from CRAN.**</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">packageVersion</span>(<span class="st">"ggpp"</span>) <span class="sc">&lt;</span> <span class="st">"0.5.5"</span>) {</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Please, update package 'ggpp' before running the code examples."</span>)</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">packageVersion</span>(<span class="st">"ggpmisc"</span>) <span class="sc">&lt;</span> <span class="st">"0.5.4"</span>) {</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Please, update package 'ggpmisc' before running the code examples."</span>)</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>Many extensions to package 'ggplot2' are available through CRAN repository, making possible the creation additional types of plots using the same approach. Many, but not all, of these packages are listed in a <span class="co">[</span><span class="ot">web page</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> with links to documentation.</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>All the figures in this page have been created with R and packages 'ggplot2',</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>'ggpmisc', 'ggbeeswarm' and 'ggdensity'. Package 'lubridate' is used for conversion of times</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>and dates from character strings.</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>The code used to create the plots is "folded" or hidden behind a triangle followed by the word "code". Click on them to make the code visible. </span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>**The code for loading of packages from the library is below, and needs to be run before any other code examples.**</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggpmisc)</span></span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggbeeswarm)</span></span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggdensity)</span></span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a><span class="in">library(lubridate)</span></span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a><span class="in"># theme_set(theme_classic(12))</span></span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_bw(12))</span></span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## Uses of graphical displays of data</span></span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a>We can distinguish two broad uses of data visualizations: 1) data exploration and analysis by a researcher or group of researchers, and 2) communication of results to the scientific community, stakeholders, decision makers or the geenral public. The difference among plots prepared for different purposes and audiences is mainly in the degree of complexity that can be expected to be understandable and in how aesthetically polished is the plot is.</span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a>:::{.callout-attention}</span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a>When we prepare a text for publication we spend time in planing how to best communicate our message, then in writing a draft, and in revising this draft, usually several times, until it is ready for submission. The same approach is the best also when producing plots for publication.</span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true" tabindex="-1"></a>As with text, asking other people to study and comment on the figures we create is important. A well designed data visualization can make the difference in the impact (number of times cited) of a publication.</span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Continuous and discrete variables</span></span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-82"><a href="#cb67-82" aria-hidden="true" tabindex="-1"></a>Some variables are inherently discontinuous, such as counts. For example, number of germinated seeds, number of plants of a given species present in plot, etc. Other variables are inherently continuous, like temperature. Even if temperature is continuous, if we grow a group of plants at 16 C and another group at 21 C, we force temperature to behave as discrete.</span>
<span id="cb67-83"><a href="#cb67-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-84"><a href="#cb67-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plotting data summaries</span></span>
<span id="cb67-85"><a href="#cb67-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-86"><a href="#cb67-86" aria-hidden="true" tabindex="-1"></a>Means, trimmed means, medians, standard errors, standard deviations, variances, linear regressions, non-linear regressions, quantile regression, smoothing splines, interpolating splines, empirical density functions in 1D or 2D.</span>
<span id="cb67-87"><a href="#cb67-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-88"><a href="#cb67-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annotations and data labels</span></span>
<span id="cb67-89"><a href="#cb67-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-90"><a href="#cb67-90" aria-hidden="true" tabindex="-1"></a>Annotations and data labels can be text, icons, small plots, small tables, etc. The difference is that annotations refer to the whole plot and data labels to individual observations, or individualy plotted summaries.</span>
<span id="cb67-91"><a href="#cb67-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-92"><a href="#cb67-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Number of observations</span></span>
<span id="cb67-93"><a href="#cb67-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-94"><a href="#cb67-94" aria-hidden="true" tabindex="-1"></a>Different types of plots are suitable depending on the number of observations. We can plot individual observations up to a point. In all cases we need to make sure that if we plot individual observations they are all visible. The number of observations and how clumped together they are can be decisive when chosing the type of plot or data visualization to use.</span>
<span id="cb67-95"><a href="#cb67-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-96"><a href="#cb67-96" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-97"><a href="#cb67-97" aria-hidden="true" tabindex="-1"></a>With few observations a _dot plot_, or variations using _jitter_ to prevent overlaps, work usually very well. With more than 10-15 observations a _boxplot_ or _beeswarm plot_ can be used and is usually preferable. With 20 or more observations a _violin plot_ can be good. These are all "rules of thumb" that need to be adjusted using common sense based on how the values are grouped and how they may overlap.</span>
<span id="cb67-98"><a href="#cb67-98" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-99"><a href="#cb67-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-100"><a href="#cb67-100" aria-hidden="true" tabindex="-1"></a><span class="fu"># Examples</span></span>
<span id="cb67-101"><a href="#cb67-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-102"><a href="#cb67-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Growth of orange trees</span></span>
<span id="cb67-103"><a href="#cb67-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-104"><a href="#cb67-104" aria-hidden="true" tabindex="-1"></a>Data set <span class="in">`Orange`</span>, included in R, contains growth measurements on five orange trees. It contains a continuous response variable (trunk circumference) and one continuous explanatory variable (date). (See <span class="in">`help(Orange)`</span> in R for additional details.)</span>
<span id="cb67-105"><a href="#cb67-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-106"><a href="#cb67-106" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scatter plot</span></span>
<span id="cb67-107"><a href="#cb67-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-108"><a href="#cb67-108" aria-hidden="true" tabindex="-1"></a>In this case it is clear which of the variables should be mapped to _x_ and _y_.</span>
<span id="cb67-109"><a href="#cb67-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-110"><a href="#cb67-110" aria-hidden="true" tabindex="-1"></a>Here we plot observations for each tree individually. This emphasizes the differences among trees. These are repeated measurements on the same trees, but even with a different point _shape_ for each tree, it is rather difficult to assess growth, which is the most interesting feature of the data.</span>
<span id="cb67-111"><a href="#cb67-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-114"><a href="#cb67-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-115"><a href="#cb67-115" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Orange)</span>
<span id="cb67-116"><a href="#cb67-116" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-117"><a href="#cb67-117" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-118"><a href="#cb67-118" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-119"><a href="#cb67-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-120"><a href="#cb67-120" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-121"><a href="#cb67-121" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference, </span>
<span id="cb67-122"><a href="#cb67-122" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> Tree, <span class="at">linetype =</span> Tree)) <span class="sc">+</span></span>
<span id="cb67-123"><a href="#cb67-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-124"><a href="#cb67-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-125"><a href="#cb67-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Trunk circumference (mm)"</span>) </span>
<span id="cb67-126"><a href="#cb67-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-127"><a href="#cb67-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-128"><a href="#cb67-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Line plot</span></span>
<span id="cb67-129"><a href="#cb67-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-130"><a href="#cb67-130" aria-hidden="true" tabindex="-1"></a>Here we connect observations with lines. This emphasizes the growth of individual trees and how it differs among trees.</span>
<span id="cb67-131"><a href="#cb67-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-134"><a href="#cb67-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-135"><a href="#cb67-135" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-136"><a href="#cb67-136" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-137"><a href="#cb67-137" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-138"><a href="#cb67-138" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-139"><a href="#cb67-139" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference, </span>
<span id="cb67-140"><a href="#cb67-140" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> Tree, <span class="at">linetype =</span> Tree)) <span class="sc">+</span></span>
<span id="cb67-141"><a href="#cb67-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb67-142"><a href="#cb67-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-143"><a href="#cb67-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-144"><a href="#cb67-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-145"><a href="#cb67-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-146"><a href="#cb67-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combined scatter and line plot</span></span>
<span id="cb67-147"><a href="#cb67-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-150"><a href="#cb67-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-151"><a href="#cb67-151" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-152"><a href="#cb67-152" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-153"><a href="#cb67-153" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-154"><a href="#cb67-154" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-155"><a href="#cb67-155" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference, </span>
<span id="cb67-156"><a href="#cb67-156" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> Tree, <span class="at">linetype =</span> Tree)) <span class="sc">+</span></span>
<span id="cb67-157"><a href="#cb67-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-158"><a href="#cb67-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb67-159"><a href="#cb67-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-160"><a href="#cb67-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-161"><a href="#cb67-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-162"><a href="#cb67-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-163"><a href="#cb67-163" aria-hidden="true" tabindex="-1"></a>Plot observations and summaries, joining the means with a line. Playing with the choice of colours, line width and size of points we can vary the relative emphasis given to individual observations and means.</span>
<span id="cb67-164"><a href="#cb67-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-167"><a href="#cb67-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-168"><a href="#cb67-168" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-169"><a href="#cb67-169" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-170"><a href="#cb67-170" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-171"><a href="#cb67-171" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-172"><a href="#cb67-172" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-173"><a href="#cb67-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb67-174"><a href="#cb67-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb67-175"><a href="#cb67-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree), <span class="at">colour =</span> <span class="st">"gray70"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-176"><a href="#cb67-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-177"><a href="#cb67-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-178"><a href="#cb67-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-179"><a href="#cb67-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-180"><a href="#cb67-180" aria-hidden="true" tabindex="-1"></a>A few tweaks to the graphic design and the impression the figure gives changes.</span>
<span id="cb67-181"><a href="#cb67-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-184"><a href="#cb67-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-185"><a href="#cb67-185" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-186"><a href="#cb67-186" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-187"><a href="#cb67-187" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-188"><a href="#cb67-188" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-189"><a href="#cb67-189" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-190"><a href="#cb67-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">fun =</span> mean, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb67-191"><a href="#cb67-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>, <span class="at">fun.data =</span> mean_se, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb67-192"><a href="#cb67-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb67-193"><a href="#cb67-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-194"><a href="#cb67-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-195"><a href="#cb67-195" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-196"><a href="#cb67-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-197"><a href="#cb67-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-198"><a href="#cb67-198" aria-hidden="true" tabindex="-1"></a>Show only means and standard errors. A very frequently used approach. As Mikael told in Topic 2 this approach is not the best when the means are computed from a small number of observations. However, plotting only means and standard deviations makes plots simpler, and can be a good approach for a talk as opposed to a scientific journal. </span>
<span id="cb67-199"><a href="#cb67-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-202"><a href="#cb67-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-203"><a href="#cb67-203" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-204"><a href="#cb67-204" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-205"><a href="#cb67-205" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-206"><a href="#cb67-206" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-207"><a href="#cb67-207" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-208"><a href="#cb67-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb67-209"><a href="#cb67-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb67-210"><a href="#cb67-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-211"><a href="#cb67-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-212"><a href="#cb67-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-213"><a href="#cb67-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-214"><a href="#cb67-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot of regression line</span></span>
<span id="cb67-215"><a href="#cb67-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-216"><a href="#cb67-216" aria-hidden="true" tabindex="-1"></a>Showing only the fitted regression line provides usually too little information.</span>
<span id="cb67-217"><a href="#cb67-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-220"><a href="#cb67-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-221"><a href="#cb67-221" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-222"><a href="#cb67-222" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-223"><a href="#cb67-223" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-224"><a href="#cb67-224" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-225"><a href="#cb67-225" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-226"><a href="#cb67-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb67-227"><a href="#cb67-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-228"><a href="#cb67-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-229"><a href="#cb67-229" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-230"><a href="#cb67-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-231"><a href="#cb67-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-232"><a href="#cb67-232" aria-hidden="true" tabindex="-1"></a>Showing observations together with a fitted smooth curve can be a good approach in some cases. Here it does not work very well.</span>
<span id="cb67-233"><a href="#cb67-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-236"><a href="#cb67-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-237"><a href="#cb67-237" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-238"><a href="#cb67-238" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-239"><a href="#cb67-239" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-240"><a href="#cb67-240" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-241"><a href="#cb67-241" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-242"><a href="#cb67-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb67-243"><a href="#cb67-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb67-244"><a href="#cb67-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-245"><a href="#cb67-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-246"><a href="#cb67-246" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-247"><a href="#cb67-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-248"><a href="#cb67-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-249"><a href="#cb67-249" aria-hidden="true" tabindex="-1"></a>Using a logarithmic transformation emphasizes the relative growth rate, i.e., the growth rate relative to the curent size of the plant. We fit a second degree polynomial.</span>
<span id="cb67-250"><a href="#cb67-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-253"><a href="#cb67-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-254"><a href="#cb67-254" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-255"><a href="#cb67-255" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-256"><a href="#cb67-256" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-257"><a href="#cb67-257" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-258"><a href="#cb67-258" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-259"><a href="#cb67-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb67-260"><a href="#cb67-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb67-261"><a href="#cb67-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb67-262"><a href="#cb67-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-263"><a href="#cb67-263" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-264"><a href="#cb67-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-265"><a href="#cb67-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-266"><a href="#cb67-266" aria-hidden="true" tabindex="-1"></a>Instead of a polynomial we can fit a smoother or spline, which is more "flexible".</span>
<span id="cb67-267"><a href="#cb67-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-270"><a href="#cb67-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-271"><a href="#cb67-271" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-272"><a href="#cb67-272" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-273"><a href="#cb67-273" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-274"><a href="#cb67-274" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-275"><a href="#cb67-275" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-276"><a href="#cb67-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> loess, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb67-277"><a href="#cb67-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tree)) <span class="sc">+</span></span>
<span id="cb67-278"><a href="#cb67-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb67-279"><a href="#cb67-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-280"><a href="#cb67-280" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-281"><a href="#cb67-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-282"><a href="#cb67-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-283"><a href="#cb67-283" aria-hidden="true" tabindex="-1"></a>We can also combine means and standard errors with a linear regression.</span>
<span id="cb67-284"><a href="#cb67-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-287"><a href="#cb67-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-288"><a href="#cb67-288" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-289"><a href="#cb67-289" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-290"><a href="#cb67-290" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-291"><a href="#cb67-291" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-292"><a href="#cb67-292" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-293"><a href="#cb67-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>() <span class="sc">+</span></span>
<span id="cb67-294"><a href="#cb67-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>))) <span class="sc">+</span></span>
<span id="cb67-295"><a href="#cb67-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb67-296"><a href="#cb67-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-297"><a href="#cb67-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-298"><a href="#cb67-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-299"><a href="#cb67-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-300"><a href="#cb67-300" aria-hidden="true" tabindex="-1"></a>The figure above seems at first sight fine, but there is a repeating pattern in time. So we label the means with the month of the year to look for an explanation. </span>
<span id="cb67-301"><a href="#cb67-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-304"><a href="#cb67-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-305"><a href="#cb67-305" aria-hidden="true" tabindex="-1"></a>my.Orange <span class="ot">&lt;-</span> Orange</span>
<span id="cb67-306"><a href="#cb67-306" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(my.Orange<span class="sc">$</span>Tree)) <span class="co"># silence warning</span></span>
<span id="cb67-307"><a href="#cb67-307" aria-hidden="true" tabindex="-1"></a>my.Orange<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1968/12/31"</span>) <span class="sc">+</span> <span class="fu">days</span>(my.Orange<span class="sc">$</span>age)</span>
<span id="cb67-308"><a href="#cb67-308" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.Orange, </span>
<span id="cb67-309"><a href="#cb67-309" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb67-310"><a href="#cb67-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>() <span class="sc">+</span></span>
<span id="cb67-311"><a href="#cb67-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>))) <span class="sc">+</span></span>
<span id="cb67-312"><a href="#cb67-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb67-313"><a href="#cb67-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">label =</span> month.abb[<span class="fu">month</span>(Date)]), </span>
<span id="cb67-314"><a href="#cb67-314" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">y =</span> <span class="dv">30</span>, <span class="at">x =</span> <span class="dv">0</span>, </span>
<span id="cb67-315"><a href="#cb67-315" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">direction =</span> <span class="st">"split"</span>), </span>
<span id="cb67-316"><a href="#cb67-316" aria-hidden="true" tabindex="-1"></a>                   <span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb67-317"><a href="#cb67-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-318"><a href="#cb67-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trunk circumference (mm)"</span>)</span>
<span id="cb67-319"><a href="#cb67-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-320"><a href="#cb67-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-321"><a href="#cb67-321" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb67-322"><a href="#cb67-322" aria-hidden="true" tabindex="-1"></a>The <span class="in">`Orange`</span> data set included in R includes only <span class="in">`age`</span> in days, but the help page gives the starting date. Reconstructing the dates in this case was important to understand the growth of the trees as it allowed us to distinguish measurements at different times of the year. This is crucial as with most perennial plants growth is fast only during the growing season.</span>
<span id="cb67-323"><a href="#cb67-323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-324"><a href="#cb67-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-325"><a href="#cb67-325" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-326"><a href="#cb67-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions to think about</span></span>
<span id="cb67-327"><a href="#cb67-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-328"><a href="#cb67-328" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Which of the plots above do you think is most informative?</span>
<span id="cb67-329"><a href="#cb67-329" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Which of the plots would you prefer to see in a talk?</span>
<span id="cb67-330"><a href="#cb67-330" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which of the plots would be best for a scientific article?`</span>
<span id="cb67-331"><a href="#cb67-331" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</span>
<span id="cb67-332"><a href="#cb67-332" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-333"><a href="#cb67-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-334"><a href="#cb67-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Height of birch seedlings</span></span>
<span id="cb67-335"><a href="#cb67-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-336"><a href="#cb67-336" aria-hidden="true" tabindex="-1"></a>Time ago in an experiment we measured a large number of tree seedlings. This data set contrasts with the one used above. While above we had data for five trees, here we have data for 350 one-summer-old tree seedlings. Measurements are all at a single time point, but different groups of seedlings were grown under different conditions. The data set is included in R package 'ggpp' (&gt;= 0.5.5).</span>
<span id="cb67-337"><a href="#cb67-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-338"><a href="#cb67-338" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dot plot</span></span>
<span id="cb67-339"><a href="#cb67-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-340"><a href="#cb67-340" aria-hidden="true" tabindex="-1"></a>A simple dot plot cannot contain many observations before points start overlapping. The plot below, even when using transparency, is nearly impossible to read usefully.-</span>
<span id="cb67-341"><a href="#cb67-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-344"><a href="#cb67-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-345"><a href="#cb67-345" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-346"><a href="#cb67-346" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-347"><a href="#cb67-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb67-348"><a href="#cb67-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-349"><a href="#cb67-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-350"><a href="#cb67-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-351"><a href="#cb67-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-352"><a href="#cb67-352" aria-hidden="true" tabindex="-1"></a>Adding _jitter_ we randomly spread the points sideways, which helps prevent the majority of the overlaps. However, as we will see below, this works rather well, but there are other options that can make the information easier to read from the plot.</span>
<span id="cb67-353"><a href="#cb67-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-356"><a href="#cb67-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-357"><a href="#cb67-357" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-358"><a href="#cb67-358" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-359"><a href="#cb67-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb67-360"><a href="#cb67-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-361"><a href="#cb67-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-362"><a href="#cb67-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-363"><a href="#cb67-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-364"><a href="#cb67-364" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plots of means and CL</span></span>
<span id="cb67-365"><a href="#cb67-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-366"><a href="#cb67-366" aria-hidden="true" tabindex="-1"></a>In publications plots like the one below are rather common. They are easy to read, but discard quite a lot of information. Confidence limits, computed in the usual way, are informative as long as the distribution is symmetrical and close to the Normal. In this case we use _P_ = 0.95, so we read these bars as indicating that there is a high probability that the true (whole-population) mean height falls within the boundaries of the bars.</span>
<span id="cb67-367"><a href="#cb67-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-370"><a href="#cb67-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-371"><a href="#cb67-371" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-372"><a href="#cb67-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-373"><a href="#cb67-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb67-374"><a href="#cb67-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">npcx =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">npcy =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-375"><a href="#cb67-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-376"><a href="#cb67-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-377"><a href="#cb67-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-378"><a href="#cb67-378" aria-hidden="true" tabindex="-1"></a>In the plot above the height scale starts at 60 cm. Most members of the scientific community can be excepted, at least if given enough time, to read the plot correctly. In contrast, the general public in many countries is likely to misinterpret a plot like this getting the impression that there is a huge difference in height btween the two groups of seedlings. So, even if it leaves a lot empty white space, the version of the plot with the _y_ axis starting at zero can be preferable.</span>
<span id="cb67-379"><a href="#cb67-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-380"><a href="#cb67-380" aria-hidden="true" tabindex="-1"></a>The first impression is very different, even for someone experienced. The CLs that looked quite large now look tiny. Of course if we use the axis scale, we realize in both cases that the whole range of the CLs is about 3 cm.</span>
<span id="cb67-381"><a href="#cb67-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-384"><a href="#cb67-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-385"><a href="#cb67-385" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-386"><a href="#cb67-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-387"><a href="#cb67-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-388"><a href="#cb67-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">npcx =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">npcy =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-389"><a href="#cb67-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-390"><a href="#cb67-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-391"><a href="#cb67-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-392"><a href="#cb67-392" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-393"><a href="#cb67-393" aria-hidden="true" tabindex="-1"></a>Even more common than CLs for error bars (in black) is plotting of standard errors as error bars (in blue). With a large number of observations, CLs bars are about twice as long than SE bars, otherwise, even longer. (Nobody I know would use a figure like this except as here to demonstrate the difference.)</span>
<span id="cb67-394"><a href="#cb67-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-397"><a href="#cb67-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-398"><a href="#cb67-398" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-399"><a href="#cb67-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb67-400"><a href="#cb67-400" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-401"><a href="#cb67-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>,</span>
<span id="cb67-402"><a href="#cb67-402" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-403"><a href="#cb67-403" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb67-404"><a href="#cb67-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>,</span>
<span id="cb67-405"><a href="#cb67-405" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.data =</span> mean_se, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb67-406"><a href="#cb67-406" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb67-407"><a href="#cb67-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb67-408"><a href="#cb67-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">npcx =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">npcy =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-409"><a href="#cb67-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-410"><a href="#cb67-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-411"><a href="#cb67-411" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-412"><a href="#cb67-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-413"><a href="#cb67-413" aria-hidden="true" tabindex="-1"></a>We can have more than one grouping and more than two categories per grouping.</span>
<span id="cb67-414"><a href="#cb67-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-417"><a href="#cb67-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-418"><a href="#cb67-418" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-419"><a href="#cb67-419" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Container, <span class="at">shape =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-420"><a href="#cb67-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-421"><a href="#cb67-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-422"><a href="#cb67-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>)</span>
<span id="cb67-423"><a href="#cb67-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-424"><a href="#cb67-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-427"><a href="#cb67-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-428"><a href="#cb67-428" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-429"><a href="#cb67-429" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-430"><a href="#cb67-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-431"><a href="#cb67-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb67-432"><a href="#cb67-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-433"><a href="#cb67-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both)</span>
<span id="cb67-434"><a href="#cb67-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-435"><a href="#cb67-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-436"><a href="#cb67-436" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simple column plot</span></span>
<span id="cb67-437"><a href="#cb67-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-438"><a href="#cb67-438" aria-hidden="true" tabindex="-1"></a>Column plots are not very popular these days, but they provide and effective way for showing differences when zero is a meaningful minimum value, like with mass.</span>
<span id="cb67-439"><a href="#cb67-439" aria-hidden="true" tabindex="-1"></a>They emphasize the overall size more than the differences in size. Depending on the quantity and aims of a study the effect relative to the whole size, maybe be more interesting than the absolute size of the effect.</span>
<span id="cb67-440"><a href="#cb67-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-443"><a href="#cb67-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-444"><a href="#cb67-444" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-445"><a href="#cb67-445" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-446"><a href="#cb67-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-447"><a href="#cb67-447" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb67-448"><a href="#cb67-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb67-449"><a href="#cb67-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb67-450"><a href="#cb67-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both)</span>
<span id="cb67-451"><a href="#cb67-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-452"><a href="#cb67-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-453"><a href="#cb67-453" aria-hidden="true" tabindex="-1"></a>Next we will create several visualizations that inform us about the properties of the data set. In general in recent years there has been an increase in the use of more informative data visualizations in scientific research, in part because of the more widespread recognition of the weaknesses of showing only means and error bars, but also because the plotting of data in more elaborate ways has become easier with increasingly powerful computers and free software like R. </span>
<span id="cb67-454"><a href="#cb67-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-455"><a href="#cb67-455" aria-hidden="true" tabindex="-1"></a>We next look at histograms, which have been in use for a very long time, and have different limitations.</span>
<span id="cb67-456"><a href="#cb67-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-457"><a href="#cb67-457" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb67-458"><a href="#cb67-458" aria-hidden="true" tabindex="-1"></a>The <span class="in">`birch.df`</span> data set included in R package 'ggpp' contains additional variables than those plotted above.</span>
<span id="cb67-459"><a href="#cb67-459" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-460"><a href="#cb67-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-461"><a href="#cb67-461" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-462"><a href="#cb67-462" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions to think about</span></span>
<span id="cb67-463"><a href="#cb67-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-464"><a href="#cb67-464" aria-hidden="true" tabindex="-1"></a>The plots above mainly describe the position of the center of the data, and a summary version of the variation.</span>
<span id="cb67-465"><a href="#cb67-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-466"><a href="#cb67-466" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Which of the plots above do you think is most informative about the height and dry mass of the seedlings?</span>
<span id="cb67-467"><a href="#cb67-467" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Which of the plots would you prefer to see in a talk?</span>
<span id="cb67-468"><a href="#cb67-468" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which of the plots would be best for a scientific article?`</span>
<span id="cb67-469"><a href="#cb67-469" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</span>
<span id="cb67-470"><a href="#cb67-470" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-471"><a href="#cb67-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-472"><a href="#cb67-472" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histogram</span></span>
<span id="cb67-473"><a href="#cb67-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-474"><a href="#cb67-474" aria-hidden="true" tabindex="-1"></a>Although histograms are usually plotted as columns, they are very different to the column plots above. In an histogram the columns do not represent summaries of a measured variable individually, they describe the absolute number (or the relative number) of observations within different ranges of values of the measured variable.</span>
<span id="cb67-475"><a href="#cb67-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-476"><a href="#cb67-476" aria-hidden="true" tabindex="-1"></a>A histogram in this case provides a simple way of describing the number of seedlings within each size _bin_ or range of heights. From this figure we can read that the largest number of seedlings are about 75 cm tall. We can also see that the shape is asymmetrical with more very short seedlings than very tall ones.</span>
<span id="cb67-477"><a href="#cb67-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-478"><a href="#cb67-478" aria-hidden="true" tabindex="-1"></a>**A "meaningful" box blot can only be created from a fairly large number of replicate observations.**</span>
<span id="cb67-479"><a href="#cb67-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-482"><a href="#cb67-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-483"><a href="#cb67-483" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb67-484"><a href="#cb67-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-485"><a href="#cb67-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-486"><a href="#cb67-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-487"><a href="#cb67-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-488"><a href="#cb67-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-489"><a href="#cb67-489" aria-hidden="true" tabindex="-1"></a>By changing <span class="in">`color`</span> and <span class="in">`fill`</span> we can emphasize the _bins_ used for counting the observations.</span>
<span id="cb67-490"><a href="#cb67-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-493"><a href="#cb67-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-494"><a href="#cb67-494" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb67-495"><a href="#cb67-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-496"><a href="#cb67-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-497"><a href="#cb67-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-498"><a href="#cb67-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-499"><a href="#cb67-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-500"><a href="#cb67-500" aria-hidden="true" tabindex="-1"></a>Two different kinds of histograms can be created. As above using _counts_ or _frequencies_, or using _density_ where density is obtained by dividing the count for each bin by the total count. In other words, so that the sum of the columns is equal to one. The shape remains unchanged.</span>
<span id="cb67-501"><a href="#cb67-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-504"><a href="#cb67-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-505"><a href="#cb67-505" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb67-506"><a href="#cb67-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb67-507"><a href="#cb67-507" aria-hidden="true" tabindex="-1"></a>           <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-508"><a href="#cb67-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-509"><a href="#cb67-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb67-510"><a href="#cb67-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-511"><a href="#cb67-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-512"><a href="#cb67-512" aria-hidden="true" tabindex="-1"></a>The seedlings were grown in two types of tray, with large and small "cells" for the soil, or containers. We can _stack_ two histograms, one on top of the other. The upper edge is unchanged from above, but each column shows separately the counts for each container type. </span>
<span id="cb67-513"><a href="#cb67-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-516"><a href="#cb67-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-517"><a href="#cb67-517" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-518"><a href="#cb67-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb67-519"><a href="#cb67-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-520"><a href="#cb67-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb67-521"><a href="#cb67-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-522"><a href="#cb67-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-523"><a href="#cb67-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-524"><a href="#cb67-524" aria-hidden="true" tabindex="-1"></a>We can also make the bars semi-transparent and overlap the histograms. As one could expect, the seedlings grown in larger containers as taller. The whole distribution of sizes is shifted by some 15 cm. In this histogram bins are 5cm wide. This plot emphasizes the difference in height between the two groups.</span>
<span id="cb67-525"><a href="#cb67-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-528"><a href="#cb67-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-529"><a href="#cb67-529" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-530"><a href="#cb67-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb67-531"><a href="#cb67-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-532"><a href="#cb67-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb67-533"><a href="#cb67-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-534"><a href="#cb67-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-535"><a href="#cb67-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-536"><a href="#cb67-536" aria-hidden="true" tabindex="-1"></a>Plots with panels that share the same axis scales can be a very effective way of visualizing data, and as each panel contains a simpler plot they do not necessarily occupy more space in a page. This plot emphasizes the "apparent' different in shape of the two height distributuions.</span>
<span id="cb67-537"><a href="#cb67-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-540"><a href="#cb67-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-541"><a href="#cb67-541" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb67-542"><a href="#cb67-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-543"><a href="#cb67-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-544"><a href="#cb67-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-545"><a href="#cb67-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-546"><a href="#cb67-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-547"><a href="#cb67-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-548"><a href="#cb67-548" aria-hidden="true" tabindex="-1"></a>As we are plotting data for height, flipping the _x_ and _y_ axes can make reading the figure more intuitive,</span>
<span id="cb67-549"><a href="#cb67-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-552"><a href="#cb67-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-553"><a href="#cb67-553" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb67-554"><a href="#cb67-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-555"><a href="#cb67-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-556"><a href="#cb67-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-557"><a href="#cb67-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-558"><a href="#cb67-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-559"><a href="#cb67-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-560"><a href="#cb67-560" aria-hidden="true" tabindex="-1"></a>:::{.callout_warning}</span>
<span id="cb67-561"><a href="#cb67-561" aria-hidden="true" tabindex="-1"></a>How a histogram looks depends on the width and position of the bins used to count observations. Histograms are still used very frequently, but their biggest advantage, the easy of computation, has been removed by modern computers. So, I do no longer use them. It is important, however, to understand how they work.</span>
<span id="cb67-562"><a href="#cb67-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-563"><a href="#cb67-563" aria-hidden="true" tabindex="-1"></a>The same plot as above after increasing bin width from 5 cm to 10 cm.</span>
<span id="cb67-564"><a href="#cb67-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-567"><a href="#cb67-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-568"><a href="#cb67-568" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb67-569"><a href="#cb67-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-570"><a href="#cb67-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-571"><a href="#cb67-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-572"><a href="#cb67-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-573"><a href="#cb67-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-574"><a href="#cb67-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-575"><a href="#cb67-575" aria-hidden="true" tabindex="-1"></a>By sligtly shifting the center of the bins along _x_, the shape of the histogram changes so that the shape becomes more similar between the two containers.</span>
<span id="cb67-576"><a href="#cb67-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-579"><a href="#cb67-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-580"><a href="#cb67-580" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb67-581"><a href="#cb67-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">center =</span> <span class="fl">72.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-582"><a href="#cb67-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-583"><a href="#cb67-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-584"><a href="#cb67-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-585"><a href="#cb67-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-586"><a href="#cb67-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-587"><a href="#cb67-587" aria-hidden="true" tabindex="-1"></a>**Take home message:** Extreme care is needed to avoid over-interpreting histograms!</span>
<span id="cb67-588"><a href="#cb67-588" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-589"><a href="#cb67-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-590"><a href="#cb67-590" aria-hidden="true" tabindex="-1"></a><span class="fu">### Box and whiskers plot</span></span>
<span id="cb67-591"><a href="#cb67-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-592"><a href="#cb67-592" aria-hidden="true" tabindex="-1"></a>Box and whiskers plots, boxplots for short, are another easy-to-compute type of plots good for describing the spread and distribution of observations. The thick line in the middle is the median, and the ends of the box the quatiles. In other words in the plot below, half of the observation are above the median and half of them below. In addition half of the observations fall within the range of height delimited by the box. The whiskers, in the absence of _outliers_, give the range of the whole data set. There are different ways determining which observations are "unusual", one is making the whiskers at most 1.5 times the size of the box, and showing the outliers as points.</span>
<span id="cb67-593"><a href="#cb67-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-596"><a href="#cb67-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-597"><a href="#cb67-597" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-598"><a href="#cb67-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">"grey95"</span>) <span class="sc">+</span></span>
<span id="cb67-599"><a href="#cb67-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-600"><a href="#cb67-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-601"><a href="#cb67-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-602"><a href="#cb67-602" aria-hidden="true" tabindex="-1"></a>In the plot above all outliers are small and the lower whisker is longer than the upper one. This indicates, as we saw with the histograms, that the distributions have a long left tail, i.e., more very short seedlings than could be expected for a symmetric distribution.</span>
<span id="cb67-603"><a href="#cb67-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-604"><a href="#cb67-604" aria-hidden="true" tabindex="-1"></a>Notches are sometimes added to boxplots, they are an _approximate_ way of testing for significant differences between the medians of groups. Here, that the ends of the notches for the two groups do not overlap suggests that the median height of plants grown in larger containers is larger. </span>
<span id="cb67-605"><a href="#cb67-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-608"><a href="#cb67-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-609"><a href="#cb67-609" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-610"><a href="#cb67-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey95"</span>) <span class="sc">+</span></span>
<span id="cb67-611"><a href="#cb67-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Number of seedlings"</span>)</span>
<span id="cb67-612"><a href="#cb67-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-613"><a href="#cb67-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-614"><a href="#cb67-614" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb67-615"><a href="#cb67-615" aria-hidden="true" tabindex="-1"></a>Boxplots drawn with fewer than 10 or even 15 observations per boxplot should be avoided. They can be very difficult to interpret, as with few observations differences in the lengths of whiskers and outliers appear simply because of the sampling process and are thus not informative about the sampled population.</span>
<span id="cb67-616"><a href="#cb67-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-617"><a href="#cb67-617" aria-hidden="true" tabindex="-1"></a>As with histograms, the values used in boxplots are rather easy to calculate. This advantage has been made irrelevant by modern computers. However, they remain a useful approach when the number of observations is rather large.</span>
<span id="cb67-618"><a href="#cb67-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-619"><a href="#cb67-619" aria-hidden="true" tabindex="-1"></a>**Take home message:** Boxplots are in my opinion frequently misused when simple dot plots would be more informative.</span>
<span id="cb67-620"><a href="#cb67-620" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-621"><a href="#cb67-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-622"><a href="#cb67-622" aria-hidden="true" tabindex="-1"></a><span class="fu">### Density plot</span></span>
<span id="cb67-623"><a href="#cb67-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-624"><a href="#cb67-624" aria-hidden="true" tabindex="-1"></a>We plotted above a histogram using density. With a procedure that computes a local density without using discrete bins, but instead a continuous smoother, we obtain a more consistent estimate of density. Still, the shape depends to some extent on the "flexibility" of the smoother user.</span>
<span id="cb67-625"><a href="#cb67-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-626"><a href="#cb67-626" aria-hidden="true" tabindex="-1"></a>In this section we draw density plots equivalent to the histograms above.</span>
<span id="cb67-627"><a href="#cb67-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-630"><a href="#cb67-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-631"><a href="#cb67-631" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb67-632"><a href="#cb67-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-633"><a href="#cb67-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-634"><a href="#cb67-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density (area = 1)"</span>)</span>
<span id="cb67-635"><a href="#cb67-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-636"><a href="#cb67-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-637"><a href="#cb67-637" aria-hidden="true" tabindex="-1"></a>When plotting densities (empirical density function or EDF) separately for each container size, we get two very similar distributions shifted by about 12 cm. Thus</span>
<span id="cb67-638"><a href="#cb67-638" aria-hidden="true" tabindex="-1"></a>the differences between the two equivalent histograms can be attributed to the procedure used to construct the histograms rather than to the data themselves.</span>
<span id="cb67-639"><a href="#cb67-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-642"><a href="#cb67-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-643"><a href="#cb67-643" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-644"><a href="#cb67-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb67-645"><a href="#cb67-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-646"><a href="#cb67-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb67-647"><a href="#cb67-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density (area = 1)"</span>)</span>
<span id="cb67-648"><a href="#cb67-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-649"><a href="#cb67-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-650"><a href="#cb67-650" aria-hidden="true" tabindex="-1"></a>We here overlap the density curve on top of the histograms to compare them.</span>
<span id="cb67-651"><a href="#cb67-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-654"><a href="#cb67-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-655"><a href="#cb67-655" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb67-656"><a href="#cb67-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="st">"grey70"</span>) <span class="sc">+</span></span>
<span id="cb67-657"><a href="#cb67-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb67-658"><a href="#cb67-658" aria-hidden="true" tabindex="-1"></a>               <span class="at">outline.type =</span> <span class="st">"upper"</span>) <span class="sc">+</span></span>
<span id="cb67-659"><a href="#cb67-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-660"><a href="#cb67-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-661"><a href="#cb67-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density (area = 1)"</span>)</span>
<span id="cb67-662"><a href="#cb67-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-663"><a href="#cb67-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-664"><a href="#cb67-664" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb67-665"><a href="#cb67-665" aria-hidden="true" tabindex="-1"></a>**Take hopme message:** In most situations smooth density plots are preferable to histograms, with the caveat, that fewer people are familiar with them.</span>
<span id="cb67-666"><a href="#cb67-666" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-667"><a href="#cb67-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-668"><a href="#cb67-668" aria-hidden="true" tabindex="-1"></a><span class="fu">### Violin plot</span></span>
<span id="cb67-669"><a href="#cb67-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-670"><a href="#cb67-670" aria-hidden="true" tabindex="-1"></a>Whe can think of violin plots as density plots with a layout similar to box plots. There is a variant, not shown, where half violins are plotted and combined with a different "half plot". </span>
<span id="cb67-671"><a href="#cb67-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-674"><a href="#cb67-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-675"><a href="#cb67-675" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-676"><a href="#cb67-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-677"><a href="#cb67-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-678"><a href="#cb67-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-679"><a href="#cb67-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-680"><a href="#cb67-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-681"><a href="#cb67-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-682"><a href="#cb67-682" aria-hidden="true" tabindex="-1"></a>We can add lines for quantiles, and a fill.</span>
<span id="cb67-683"><a href="#cb67-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-686"><a href="#cb67-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-687"><a href="#cb67-687" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-688"><a href="#cb67-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">fill =</span> <span class="st">"grey98"</span>) <span class="sc">+</span></span>
<span id="cb67-689"><a href="#cb67-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-690"><a href="#cb67-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-691"><a href="#cb67-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-692"><a href="#cb67-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-693"><a href="#cb67-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-694"><a href="#cb67-694" aria-hidden="true" tabindex="-1"></a>To demostrate this, we next plot together boxplots and violin plots.</span>
<span id="cb67-695"><a href="#cb67-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-698"><a href="#cb67-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-699"><a href="#cb67-699" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-700"><a href="#cb67-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-701"><a href="#cb67-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">"grey95"</span>) <span class="sc">+</span></span>
<span id="cb67-702"><a href="#cb67-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-703"><a href="#cb67-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-704"><a href="#cb67-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-705"><a href="#cb67-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-706"><a href="#cb67-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-707"><a href="#cb67-707" aria-hidden="true" tabindex="-1"></a>As above, we can add notches to the box plots.</span>
<span id="cb67-708"><a href="#cb67-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-711"><a href="#cb67-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-712"><a href="#cb67-712" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-713"><a href="#cb67-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Container), <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-714"><a href="#cb67-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-715"><a href="#cb67-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-716"><a href="#cb67-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>), </span>
<span id="cb67-717"><a href="#cb67-717" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb67-718"><a href="#cb67-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-719"><a href="#cb67-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-720"><a href="#cb67-720" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb67-721"><a href="#cb67-721" aria-hidden="true" tabindex="-1"></a>**Take home message:** Violin plots are a handy way of plotting density distributions for different groups side by side for comparison. Specially when we have several groups they are very useful. As with density plots, several replicate observations (&gt; 10 to 15 per violin) are needed for fit the densities in violin plots.</span>
<span id="cb67-722"><a href="#cb67-722" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-723"><a href="#cb67-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-724"><a href="#cb67-724" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bee swarm plot</span></span>
<span id="cb67-725"><a href="#cb67-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-726"><a href="#cb67-726" aria-hidden="true" tabindex="-1"></a>If we spread the actual observations so as to approximatelly fill a violin plot we get what could be called a _quasirandom_ bee swarm plot.</span>
<span id="cb67-727"><a href="#cb67-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-730"><a href="#cb67-730" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-731"><a href="#cb67-731" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-732"><a href="#cb67-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-733"><a href="#cb67-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-734"><a href="#cb67-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb67-735"><a href="#cb67-735" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-736"><a href="#cb67-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-737"><a href="#cb67-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-738"><a href="#cb67-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-739"><a href="#cb67-739" aria-hidden="true" tabindex="-1"></a>This type of plot can be effectively combined with a violin plot.</span>
<span id="cb67-740"><a href="#cb67-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-743"><a href="#cb67-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-744"><a href="#cb67-744" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-745"><a href="#cb67-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Container), <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-746"><a href="#cb67-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-747"><a href="#cb67-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-748"><a href="#cb67-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb67-749"><a href="#cb67-749" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-750"><a href="#cb67-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-751"><a href="#cb67-751" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-752"><a href="#cb67-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-753"><a href="#cb67-753" aria-hidden="true" tabindex="-1"></a>A more compact version of a _bee swarm_ plot is also possible.</span>
<span id="cb67-754"><a href="#cb67-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-757"><a href="#cb67-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-758"><a href="#cb67-758" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-759"><a href="#cb67-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb67-760"><a href="#cb67-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-761"><a href="#cb67-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb67-762"><a href="#cb67-762" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-763"><a href="#cb67-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-764"><a href="#cb67-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-765"><a href="#cb67-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-766"><a href="#cb67-766" aria-hidden="true" tabindex="-1"></a>As well as a one-sided version, that we can combine with a boxplot.</span>
<span id="cb67-767"><a href="#cb67-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-770"><a href="#cb67-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-771"><a href="#cb67-771" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Container, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-772"><a href="#cb67-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="at">side =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-773"><a href="#cb67-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-774"><a href="#cb67-774" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb67-775"><a href="#cb67-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-776"><a href="#cb67-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>),</span>
<span id="cb67-777"><a href="#cb67-777" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-778"><a href="#cb67-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb67-779"><a href="#cb67-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-780"><a href="#cb67-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-781"><a href="#cb67-781" aria-hidden="true" tabindex="-1"></a><span class="fu">### Jittered dot plot and boxplot</span></span>
<span id="cb67-782"><a href="#cb67-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-785"><a href="#cb67-785" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-786"><a href="#cb67-786" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-787"><a href="#cb67-787" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density, <span class="at">colour =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-788"><a href="#cb67-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>,</span>
<span id="cb67-789"><a href="#cb67-789" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb67-790"><a href="#cb67-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-791"><a href="#cb67-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-792"><a href="#cb67-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>, <span class="at">x =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb67-793"><a href="#cb67-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb67-794"><a href="#cb67-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-795"><a href="#cb67-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-796"><a href="#cb67-796" aria-hidden="true" tabindex="-1"></a><span class="fu">### Beeswarm, violin and box plots combined</span></span>
<span id="cb67-797"><a href="#cb67-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-800"><a href="#cb67-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-801"><a href="#cb67-801" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-802"><a href="#cb67-802" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> Density, <span class="at">colour =</span> Density, <span class="at">group =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-803"><a href="#cb67-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-804"><a href="#cb67-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-805"><a href="#cb67-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-806"><a href="#cb67-806" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-807"><a href="#cb67-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-808"><a href="#cb67-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb67-809"><a href="#cb67-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>), </span>
<span id="cb67-810"><a href="#cb67-810" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb67-811"><a href="#cb67-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-812"><a href="#cb67-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-813"><a href="#cb67-813" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb67-814"><a href="#cb67-814" aria-hidden="true" tabindex="-1"></a>The data originate from many seedlings, and several variables have been measured. This means that there are many different ways in which we can plot them emphasizing different features and relationships.</span>
<span id="cb67-815"><a href="#cb67-815" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-816"><a href="#cb67-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-817"><a href="#cb67-817" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-818"><a href="#cb67-818" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question to think about</span></span>
<span id="cb67-819"><a href="#cb67-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-820"><a href="#cb67-820" aria-hidden="true" tabindex="-1"></a>Considering plots that describe the distribution and variation in the data, please answer the following questions.</span>
<span id="cb67-821"><a href="#cb67-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-822"><a href="#cb67-822" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Which of the plots above do you think is most informative?</span>
<span id="cb67-823"><a href="#cb67-823" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Which of the plots would you prefer to see in a talk?</span>
<span id="cb67-824"><a href="#cb67-824" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which of the plots would be best for a scientific article?`</span>
<span id="cb67-825"><a href="#cb67-825" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</span>
<span id="cb67-826"><a href="#cb67-826" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-827"><a href="#cb67-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-828"><a href="#cb67-828" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dry mass of stems and roots of birch seedlings</span></span>
<span id="cb67-829"><a href="#cb67-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-832"><a href="#cb67-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-833"><a href="#cb67-833" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(birch.df)</span>
<span id="cb67-834"><a href="#cb67-834" aria-hidden="true" tabindex="-1"></a>stem.df <span class="ot">&lt;-</span> birch.df[ , <span class="fu">c</span>(<span class="st">"Container"</span>, <span class="st">"Density"</span>,   <span class="st">"block"</span>, <span class="st">"dwstem"</span>)]</span>
<span id="cb67-835"><a href="#cb67-835" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stem.df)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"dry.weight"</span></span>
<span id="cb67-836"><a href="#cb67-836" aria-hidden="true" tabindex="-1"></a>stem.df<span class="sc">$</span>Part <span class="ot">&lt;-</span> <span class="st">"stem"</span></span>
<span id="cb67-837"><a href="#cb67-837" aria-hidden="true" tabindex="-1"></a>root.df <span class="ot">&lt;-</span> birch.df[ , <span class="fu">c</span>(<span class="st">"Container"</span>, <span class="st">"Density"</span>,   <span class="st">"block"</span>, <span class="st">"dwroot"</span>)]</span>
<span id="cb67-838"><a href="#cb67-838" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(root.df)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"dry.weight"</span></span>
<span id="cb67-839"><a href="#cb67-839" aria-hidden="true" tabindex="-1"></a>root.df<span class="sc">$</span>Part <span class="ot">&lt;-</span> <span class="st">"root"</span></span>
<span id="cb67-840"><a href="#cb67-840" aria-hidden="true" tabindex="-1"></a>birch_dw.df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stem.df, root.df)</span>
<span id="cb67-841"><a href="#cb67-841" aria-hidden="true" tabindex="-1"></a>birch_dw.df<span class="sc">$</span>Part <span class="ot">&lt;-</span> <span class="fu">factor</span>(birch_dw.df<span class="sc">$</span>Part, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"stem"</span>, <span class="st">"root"</span>))</span>
<span id="cb67-842"><a href="#cb67-842" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(stem.df, root.df)</span>
<span id="cb67-843"><a href="#cb67-843" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(birch_dw.df)</span>
<span id="cb67-844"><a href="#cb67-844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-845"><a href="#cb67-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-848"><a href="#cb67-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-849"><a href="#cb67-849" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch_dw.df, </span>
<span id="cb67-850"><a href="#cb67-850" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> dry.weight <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density, <span class="at">fill =</span> Part)) <span class="sc">+</span></span>
<span id="cb67-851"><a href="#cb67-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-852"><a href="#cb67-852" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb67-853"><a href="#cb67-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>, <span class="at">fun.data =</span> mean_cl_normal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-854"><a href="#cb67-854" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack_minmax</span>()) <span class="sc">+</span></span>
<span id="cb67-855"><a href="#cb67-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb67-856"><a href="#cb67-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb67-857"><a href="#cb67-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container))</span>
<span id="cb67-858"><a href="#cb67-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-859"><a href="#cb67-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-860"><a href="#cb67-860" aria-hidden="true" tabindex="-1"></a><span class="fu">### "Composition" columns</span></span>
<span id="cb67-861"><a href="#cb67-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-864"><a href="#cb67-864" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-865"><a href="#cb67-865" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch_dw.df, </span>
<span id="cb67-866"><a href="#cb67-866" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> dry.weight <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density, <span class="at">fill =</span> Part)) <span class="sc">+</span></span>
<span id="cb67-867"><a href="#cb67-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-868"><a href="#cb67-868" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb67-869"><a href="#cb67-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry mass allocation (/1)"</span>) <span class="sc">+</span></span>
<span id="cb67-870"><a href="#cb67-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb67-871"><a href="#cb67-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container))</span>
<span id="cb67-872"><a href="#cb67-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-873"><a href="#cb67-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-874"><a href="#cb67-874" aria-hidden="true" tabindex="-1"></a><span class="fu">### Side-by-side columns</span></span>
<span id="cb67-875"><a href="#cb67-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-878"><a href="#cb67-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-879"><a href="#cb67-879" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch_dw.df, </span>
<span id="cb67-880"><a href="#cb67-880" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> dry.weight <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density, <span class="at">fill =</span> Part)) <span class="sc">+</span></span>
<span id="cb67-881"><a href="#cb67-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-882"><a href="#cb67-882" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb67-883"><a href="#cb67-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"linerange"</span>, <span class="at">fun.data =</span> mean_se, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-884"><a href="#cb67-884" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.67</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb67-885"><a href="#cb67-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seedling dry mass (g)"</span>) <span class="sc">+</span></span>
<span id="cb67-886"><a href="#cb67-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb67-887"><a href="#cb67-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container))</span>
<span id="cb67-888"><a href="#cb67-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-889"><a href="#cb67-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-890"><a href="#cb67-890" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-891"><a href="#cb67-891" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question to think about</span></span>
<span id="cb67-892"><a href="#cb67-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-893"><a href="#cb67-893" aria-hidden="true" tabindex="-1"></a>Considering plots that describe the dry mass of the seedlings, please answer the following questions.</span>
<span id="cb67-894"><a href="#cb67-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-895"><a href="#cb67-895" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Which of the plots above do you think is most informative?</span>
<span id="cb67-896"><a href="#cb67-896" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Which of the plots would you prefer to see in a talk?</span>
<span id="cb67-897"><a href="#cb67-897" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which of the plots would be best for a scientific article?`</span>
<span id="cb67-898"><a href="#cb67-898" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</span>
<span id="cb67-899"><a href="#cb67-899" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-900"><a href="#cb67-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-901"><a href="#cb67-901" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allometric relationships of birch seedlings</span></span>
<span id="cb67-902"><a href="#cb67-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-903"><a href="#cb67-903" aria-hidden="true" tabindex="-1"></a>In the <span class="in">`birch.df`</span> used above, we find multiple measured continuous variables. In this case, we will plot one continuous variable against another, and in many cases add a grouping with a categorical variable. In some cases, there is no clear criterion for the assigment of variables to _x_ and _y_ as both are response variables subject to biological variability and measurement errors. </span>
<span id="cb67-904"><a href="#cb67-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-905"><a href="#cb67-905" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scatter plot</span></span>
<span id="cb67-906"><a href="#cb67-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-907"><a href="#cb67-907" aria-hidden="true" tabindex="-1"></a>A plot with individual observations represented by points is called a scatter plot when both varaibles are continuous (points are scattered in the plotting area along both axes) and a dot plot when one of the variables is discrete and points are aligned by group.</span>
<span id="cb67-908"><a href="#cb67-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-909"><a href="#cb67-909" aria-hidden="true" tabindex="-1"></a>Transparency is a way of making the overlaps among points visible.</span>
<span id="cb67-910"><a href="#cb67-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-913"><a href="#cb67-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-914"><a href="#cb67-914" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-915"><a href="#cb67-915" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> diameter, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Container)) <span class="sc">+</span></span>
<span id="cb67-916"><a href="#cb67-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-917"><a href="#cb67-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb67-918"><a href="#cb67-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-919"><a href="#cb67-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-920"><a href="#cb67-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="st">"Root collar diameter (mm)"</span>)</span>
<span id="cb67-921"><a href="#cb67-921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-922"><a href="#cb67-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-923"><a href="#cb67-923" aria-hidden="true" tabindex="-1"></a>Using "facets" or panels with consistent scales is an alternative approach. The plot above emphasizes that the relationship between the variables seems to be the same in both groups. The figure below better highlights the differences is size and de-emphasizes the averlap.</span>
<span id="cb67-924"><a href="#cb67-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-927"><a href="#cb67-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-928"><a href="#cb67-928" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-929"><a href="#cb67-929" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> diameter, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-930"><a href="#cb67-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-931"><a href="#cb67-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-932"><a href="#cb67-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-933"><a href="#cb67-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-934"><a href="#cb67-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="st">"Root collar diameter (mm)"</span>)</span>
<span id="cb67-935"><a href="#cb67-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-936"><a href="#cb67-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-937"><a href="#cb67-937" aria-hidden="true" tabindex="-1"></a>Based of first principles, we can assume that the cross section area of base of the stem would relate closely to the size of the whole seedling measured as dry mass. We plot the same plot after transforming diameter into cross-section area. The curvature of the cloud of points, seen above, vanishes.</span>
<span id="cb67-938"><a href="#cb67-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-941"><a href="#cb67-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-942"><a href="#cb67-942" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-943"><a href="#cb67-943" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-944"><a href="#cb67-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-945"><a href="#cb67-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-946"><a href="#cb67-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-947"><a href="#cb67-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-948"><a href="#cb67-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-949"><a href="#cb67-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-950"><a href="#cb67-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-951"><a href="#cb67-951" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rug plot</span></span>
<span id="cb67-952"><a href="#cb67-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-953"><a href="#cb67-953" aria-hidden="true" tabindex="-1"></a>Rug lines, like the threads at the edge of a rug, are plotted on the edges and follow on one of _x_ or _y_ at a time. By default, for each observation, one segment is drawn on the left edge and another one on the bottom edge.</span>
<span id="cb67-954"><a href="#cb67-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-957"><a href="#cb67-957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-958"><a href="#cb67-958" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-959"><a href="#cb67-959" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-960"><a href="#cb67-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-961"><a href="#cb67-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-962"><a href="#cb67-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-963"><a href="#cb67-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-964"><a href="#cb67-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-965"><a href="#cb67-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-966"><a href="#cb67-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-967"><a href="#cb67-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-968"><a href="#cb67-968" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2D summaries and centroids</span></span>
<span id="cb67-969"><a href="#cb67-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-970"><a href="#cb67-970" aria-hidden="true" tabindex="-1"></a>We mark the point given by $\bar{x}$ and $\bar{y}$ with a **+**. We also add as an annotation the result from a correlation test.</span>
<span id="cb67-971"><a href="#cb67-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-974"><a href="#cb67-974" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-975"><a href="#cb67-975" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-976"><a href="#cb67-976" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-977"><a href="#cb67-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-978"><a href="#cb67-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">shape =</span> <span class="st">"+"</span>, <span class="at">size =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb67-979"><a href="#cb67-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">geom =</span> <span class="st">"rug"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-980"><a href="#cb67-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_correlation</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"R"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb67-981"><a href="#cb67-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb67-982"><a href="#cb67-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-983"><a href="#cb67-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-984"><a href="#cb67-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-985"><a href="#cb67-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-986"><a href="#cb67-986" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2D density</span></span>
<span id="cb67-987"><a href="#cb67-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-988"><a href="#cb67-988" aria-hidden="true" tabindex="-1"></a>As we have two response variables, each subjected to variation, it is informative to estimate the empirical density function in two dimensions (a 2D EDF). In other words for each combination of _x_ and _y_ values we obtain a density estimate. We represent this density on a hypothetical _z_ axis, that we represent with isolines. The traditional approach makes these lines equidistant.</span>
<span id="cb67-989"><a href="#cb67-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-992"><a href="#cb67-992" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-993"><a href="#cb67-993" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-994"><a href="#cb67-994" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-995"><a href="#cb67-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">adjust =</span> <span class="fl">0.66</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-996"><a href="#cb67-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-997"><a href="#cb67-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-998"><a href="#cb67-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-999"><a href="#cb67-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-1000"><a href="#cb67-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1001"><a href="#cb67-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1002"><a href="#cb67-1002" aria-hidden="true" tabindex="-1"></a>An alternative, and more easily interpretable approach sets the isolines based on specific probabilities. Here the central dark area includes 50% of the density and is thus equivalent to the box in a box plot.</span>
<span id="cb67-1003"><a href="#cb67-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1006"><a href="#cb67-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1007"><a href="#cb67-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-1008"><a href="#cb67-1008" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-1009"><a href="#cb67-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_hdr</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1010"><a href="#cb67-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-1011"><a href="#cb67-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-1012"><a href="#cb67-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-1013"><a href="#cb67-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, </span>
<span id="cb67-1014"><a href="#cb67-1014" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-1015"><a href="#cb67-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1016"><a href="#cb67-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1017"><a href="#cb67-1017" aria-hidden="true" tabindex="-1"></a>We mark the point given by the medians of $x$ and $y$ with a **+**.</span>
<span id="cb67-1018"><a href="#cb67-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1021"><a href="#cb67-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1022"><a href="#cb67-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-1023"><a href="#cb67-1023" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-1024"><a href="#cb67-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_hdr</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1025"><a href="#cb67-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">shape =</span> <span class="st">"+"</span>, <span class="at">size =</span> <span class="dv">7</span>, </span>
<span id="cb67-1026"><a href="#cb67-1026" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fun =</span> median) <span class="sc">+</span></span>
<span id="cb67-1027"><a href="#cb67-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.x =</span> <span class="st">"left"</span>, <span class="at">vstep =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-1028"><a href="#cb67-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-1029"><a href="#cb67-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-1030"><a href="#cb67-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-1031"><a href="#cb67-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1032"><a href="#cb67-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1033"><a href="#cb67-1033" aria-hidden="true" tabindex="-1"></a>The equivalent of a 2D histogram is based on counts in 2D bins. The bins can be square shaped or hexagonal.</span>
<span id="cb67-1034"><a href="#cb67-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1035"><a href="#cb67-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression line</span></span>
<span id="cb67-1036"><a href="#cb67-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1037"><a href="#cb67-1037" aria-hidden="true" tabindex="-1"></a>As we will see later, fitting regression lines or other statistical models is a very powerful way of describing observations as well as for prediction. Here, as both variables, mapped to _x_ and _y_, are subject to error variation we need to use a special kind of regression, _major axis regression_.</span>
<span id="cb67-1038"><a href="#cb67-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1041"><a href="#cb67-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1042"><a href="#cb67-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-1043"><a href="#cb67-1043" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-1044"><a href="#cb67-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1045"><a href="#cb67-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>)), <span class="at">vstep =</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1046"><a href="#cb67-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb67-1047"><a href="#cb67-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-1048"><a href="#cb67-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-1049"><a href="#cb67-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-1050"><a href="#cb67-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1051"><a href="#cb67-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1052"><a href="#cb67-1052" aria-hidden="true" tabindex="-1"></a>A regresion jointly fitted to all data.</span>
<span id="cb67-1053"><a href="#cb67-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1056"><a href="#cb67-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1057"><a href="#cb67-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-1058"><a href="#cb67-1058" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pi <span class="sc">*</span> diameter<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>)) <span class="sc">+</span></span>
<span id="cb67-1059"><a href="#cb67-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1060"><a href="#cb67-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>)), <span class="at">vstep =</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1061"><a href="#cb67-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Container), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-1062"><a href="#cb67-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-1063"><a href="#cb67-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-1064"><a href="#cb67-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Root collar area "</span><span class="sc">*</span>(mm<span class="sc">^</span>{<span class="dv">2</span>})))</span>
<span id="cb67-1065"><a href="#cb67-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1066"><a href="#cb67-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1067"><a href="#cb67-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1068"><a href="#cb67-1068" aria-hidden="true" tabindex="-1"></a>Here, separate lines for each container size and each density.</span>
<span id="cb67-1069"><a href="#cb67-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1072"><a href="#cb67-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1073"><a href="#cb67-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-1074"><a href="#cb67-1074" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-1075"><a href="#cb67-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-1076"><a href="#cb67-1076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1077"><a href="#cb67-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ma_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb67-1078"><a href="#cb67-1078" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.y =</span> <span class="st">"bottom"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb67-1079"><a href="#cb67-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb67-1080"><a href="#cb67-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-1081"><a href="#cb67-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.75</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb67-1082"><a href="#cb67-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>)</span>
<span id="cb67-1083"><a href="#cb67-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1084"><a href="#cb67-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1085"><a href="#cb67-1085" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb67-1086"><a href="#cb67-1086" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question to think about</span></span>
<span id="cb67-1087"><a href="#cb67-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1088"><a href="#cb67-1088" aria-hidden="true" tabindex="-1"></a>Considering plots that describe the relationship between height and dry mass, please answer the following questions.</span>
<span id="cb67-1089"><a href="#cb67-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1090"><a href="#cb67-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Which of the plots above do you think is most informative?</span>
<span id="cb67-1091"><a href="#cb67-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Which of the plots would you prefer to see in a talk?</span>
<span id="cb67-1092"><a href="#cb67-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which of the plots would be best for a scientific article?`</span>
<span id="cb67-1093"><a href="#cb67-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Can you think of a better design, maybe combining features from the different plots? (First decide what feature of the data you will emphasize.)</span>
<span id="cb67-1094"><a href="#cb67-1094" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-1095"><a href="#cb67-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1096"><a href="#cb67-1096" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb67-1097"><a href="#cb67-1097" aria-hidden="true" tabindex="-1"></a><span class="fu"># Why not linear regression?</span></span>
<span id="cb67-1098"><a href="#cb67-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1099"><a href="#cb67-1099" aria-hidden="true" tabindex="-1"></a>Here using linear regression would be wrong!</span>
<span id="cb67-1100"><a href="#cb67-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1101"><a href="#cb67-1101" aria-hidden="true" tabindex="-1"></a>The lines in this first plot are linear regressions of _y_ on _x_, assuming _x_ (dry mass) is measured without error.  </span>
<span id="cb67-1102"><a href="#cb67-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1105"><a href="#cb67-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1106"><a href="#cb67-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-1107"><a href="#cb67-1107" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-1108"><a href="#cb67-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-1109"><a href="#cb67-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-1110"><a href="#cb67-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb67-1111"><a href="#cb67-1111" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.y =</span> <span class="st">"bottom"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb67-1112"><a href="#cb67-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb67-1113"><a href="#cb67-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-1114"><a href="#cb67-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.75</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb67-1115"><a href="#cb67-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>)</span>
<span id="cb67-1116"><a href="#cb67-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1117"><a href="#cb67-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1118"><a href="#cb67-1118" aria-hidden="true" tabindex="-1"></a>The lines in this first plot are linear regressions of _x_ on _y_, assuming _y_ (height) is measured without error.  </span>
<span id="cb67-1119"><a href="#cb67-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1120"><a href="#cb67-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1123"><a href="#cb67-1123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1124"><a href="#cb67-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birch.df, </span>
<span id="cb67-1125"><a href="#cb67-1125" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">color =</span> Density)) <span class="sc">+</span></span>
<span id="cb67-1126"><a href="#cb67-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb67-1127"><a href="#cb67-1127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">orientation =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb67-1128"><a href="#cb67-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"n"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb67-1129"><a href="#cb67-1129" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.y =</span> <span class="st">"bottom"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>, <span class="at">orientation =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb67-1130"><a href="#cb67-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb67-1131"><a href="#cb67-1131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container), <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb67-1132"><a href="#cb67-1132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.75</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"colour"</span>, <span class="st">"fill"</span>)) <span class="sc">+</span></span>
<span id="cb67-1133"><a href="#cb67-1133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seeling dry mass (g)"</span>, <span class="at">y =</span> <span class="st">"Seedling height (cm)"</span>)</span>
<span id="cb67-1134"><a href="#cb67-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1135"><a href="#cb67-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1136"><a href="#cb67-1136" aria-hidden="true" tabindex="-1"></a>The lines are drastically different!</span>
<span id="cb67-1137"><a href="#cb67-1137" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-1138"><a href="#cb67-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1139"><a href="#cb67-1139" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb67-1140"><a href="#cb67-1140" aria-hidden="true" tabindex="-1"></a><span class="fu"># Friends don't let friends make bad graphs</span></span>
<span id="cb67-1141"><a href="#cb67-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1142"><a href="#cb67-1142" aria-hidden="true" tabindex="-1"></a>A nice set of paired good and bad plots.</span>
<span id="cb67-1143"><a href="#cb67-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1144"><a href="#cb67-1144" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Friends don't let friends...</span><span class="co">](https://github.com/cxli233/FriendsDontLetFriends#friends-dont-let-friends-make-bad-graphs)</span></span>
<span id="cb67-1145"><a href="#cb67-1145" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-1146"><a href="#cb67-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1147"><a href="#cb67-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other plot examples</span></span>
<span id="cb67-1148"><a href="#cb67-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1149"><a href="#cb67-1149" aria-hidden="true" tabindex="-1"></a>These links are here in case you would like to see some additional possibilities, or as a cookbook of code examples if you need for reports or the thesis.</span>
<span id="cb67-1150"><a href="#cb67-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1151"><a href="#cb67-1151" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Quadrant and volcano plots</span><span class="co">](quadrant-volcano-plots.qmd)</span> are a special type of scatter plots.</span>
<span id="cb67-1152"><a href="#cb67-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1153"><a href="#cb67-1153" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Data labels in bar and column plots</span><span class="co">](bar-col-plots.qmd)</span> a few examples using package 'ggpp'.</span>
<span id="cb67-1154"><a href="#cb67-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1155"><a href="#cb67-1155" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Index to other pages at this web site</span><span class="co">](../index.qmd)</span>, including some describing additional types of plots and other uses of R.</span>
<span id="cb67-1156"><a href="#cb67-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1157"><a href="#cb67-1157" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Index of material at this site for course IPS-003</span><span class="co">](../ips-003.qmd)</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0003-3385-972X">
<p>P. J. Aphalo @ ORCID</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 ISSN 2343-3248 (Helsinki, Finland)
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../about/about.html">
<p>© 2015-2023 Pedro J. Aphalo</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>